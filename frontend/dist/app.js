var ls=Object.defineProperty;var Ba=e=>{throw TypeError(e)};var cs=(e,t,r)=>t in e?ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var lr=(e,t,r)=>cs(e,typeof t!="symbol"?t+"":t,r),ca=(e,t,r)=>t.has(e)||Ba("Cannot "+r);var G=(e,t,r)=>(ca(e,t,"read from private field"),r?r.call(e):t.get(e)),_e=(e,t,r)=>t.has(e)?Ba("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Rt=(e,t,r,a)=>(ca(e,t,"write to private field"),a?a.call(e,r):t.set(e,r),r),Tt=(e,t,r)=>(ca(e,t,"access private method"),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();const Wa=!1;var Oa=Array.isArray,ds=Array.prototype.indexOf,ja=Array.from,vs=Object.defineProperty,Ut=Object.getOwnPropertyDescriptor,gn=Object.getOwnPropertyDescriptors,us=Object.prototype,fs=Array.prototype,Aa=Object.getPrototypeOf,Va=Object.isExtensible;function hs(e){return typeof e=="function"}const pt=()=>{};function ps(e){return e()}function Nr(e){for(var t=0;t<e.length;t++)e[t]()}const nt=2,bn=4,Qr=8,ea=16,Ct=32,sr=64,zr=128,Ge=256,Lr=512,Le=1024,lt=2048,Lt=4096,yt=8192,ta=16384,yn=32768,Sr=65536,_s=1<<17,gs=1<<19,wn=1<<20,ga=1<<21,wt=Symbol("$state"),bs=Symbol("legacy props"),ys=Symbol("");function mn(e){return e===this.v}function ws(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function $a(e){return!ws(e,this.v)}function ms(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function xs(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Cs(e){throw new Error("https://svelte.dev/e/effect_orphan")}function ks(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Es(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ts(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ss(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qs(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let ir=!1,Os=!1;function js(){ir=!0}const Da=1,Pa=2,xn=4,As=8,$s=16,Ds=1,Ps=2,Rs=4,Ms=8,Fs=16,Is=1,Ns=2,zs=4,Ls=1,Hs=2,ze=Symbol(),Bs="http://www.w3.org/1999/xhtml";function Ws(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let ge=null;function Ga(e){ge=e}function Ee(e,t=!1,r){var a=ge={p:ge,c:null,d:!1,e:null,m:!1,s:e,x:null,l:null};ir&&!t&&(ge.l={s:null,u:null,r1:[],r2:Ye(!1)}),$n(()=>{a.d=!0})}function Te(e){const t=ge;if(t!==null){e!==void 0&&(t.x=e);const o=t.e;if(o!==null){var r=ve,a=he;t.e=null;try{for(var n=0;n<o.length;n++){var s=o[n];ct(s.effect),Xe(s.reaction),Ht(s.fn)}}finally{ct(r),Xe(a)}}ge=t.p,t.m=!0}return e||{}}function qr(){return!ir||ge!==null&&ge.l===null}function pe(e){if(typeof e!="object"||e===null||wt in e)return e;const t=Aa(e);if(t!==us&&t!==fs)return e;var r=new Map,a=Oa(e),n=A(0),s=he,o=c=>{var u=he;Xe(s);var f=c();return Xe(u),f};return a&&r.set("length",A(e.length)),new Proxy(e,{defineProperty(c,u,f){(!("value"in f)||f.configurable===!1||f.enumerable===!1||f.writable===!1)&&Ts();var p=r.get(u);return p===void 0?(p=o(()=>A(f.value)),r.set(u,p)):l(p,o(()=>pe(f.value))),!0},deleteProperty(c,u){var f=r.get(u);if(f===void 0)u in c&&(r.set(u,o(()=>A(ze))),da(n));else{if(a&&typeof u=="string"){var p=r.get("length"),_=Number(u);Number.isInteger(_)&&_<p.v&&l(p,_)}l(f,ze),da(n)}return!0},get(c,u,f){var h;if(u===wt)return e;var p=r.get(u),_=u in c;if(p===void 0&&(!_||(h=Ut(c,u))!=null&&h.writable)&&(p=o(()=>A(pe(_?c[u]:ze))),r.set(u,p)),p!==void 0){var d=i(p);return d===ze?void 0:d}return Reflect.get(c,u,f)},getOwnPropertyDescriptor(c,u){var f=Reflect.getOwnPropertyDescriptor(c,u);if(f&&"value"in f){var p=r.get(u);p&&(f.value=i(p))}else if(f===void 0){var _=r.get(u),d=_==null?void 0:_.v;if(_!==void 0&&d!==ze)return{enumerable:!0,configurable:!0,value:d,writable:!0}}return f},has(c,u){var d;if(u===wt)return!0;var f=r.get(u),p=f!==void 0&&f.v!==ze||Reflect.has(c,u);if(f!==void 0||ve!==null&&(!p||(d=Ut(c,u))!=null&&d.writable)){f===void 0&&(f=o(()=>A(p?pe(c[u]):ze)),r.set(u,f));var _=i(f);if(_===ze)return!1}return p},set(c,u,f,p){var F;var _=r.get(u),d=u in c;if(a&&u==="length")for(var h=f;h<_.v;h+=1){var b=r.get(h+"");b!==void 0?l(b,ze):h in c&&(b=o(()=>A(ze)),r.set(h+"",b))}_===void 0?(!d||(F=Ut(c,u))!=null&&F.writable)&&(_=o(()=>A(void 0)),l(_,o(()=>pe(f))),r.set(u,_)):(d=_.v!==ze,l(_,o(()=>pe(f))));var w=Reflect.getOwnPropertyDescriptor(c,u);if(w!=null&&w.set&&w.set.call(p,f),!d){if(a&&typeof u=="string"){var q=r.get("length"),R=Number(u);Number.isInteger(R)&&R>=q.v&&l(q,R+1)}da(n)}return!0},ownKeys(c){i(n);var u=Reflect.ownKeys(c).filter(_=>{var d=r.get(_);return d===void 0||d.v!==ze});for(var[f,p]of r)p.v!==ze&&!(f in c)&&u.push(f);return u},setPrototypeOf(){Ss()}})}function da(e,t=1){l(e,e.v+t)}function Ja(e){try{if(e!==null&&typeof e=="object"&&wt in e)return e[wt]}catch{}return e}function Vs(e,t){return Object.is(Ja(e),Ja(t))}function er(e){var t=nt|lt,r=he!==null&&(he.f&nt)!==0?he:null;return ve===null||r!==null&&(r.f&Ge)!==0?t|=Ge:ve.f|=wn,{ctx:ge,deps:null,effects:null,equals:mn,f:t,fn:e,reactions:null,rv:0,v:null,wv:0,parent:r??ve}}function me(e){const t=er(e);return zn(t),t}function Ra(e){const t=er(e);return t.equals=$a,t}function Cn(e){var t=e.effects;if(t!==null){e.effects=null;for(var r=0;r<t.length;r+=1)mt(t[r])}}function Gs(e){for(var t=e.parent;t!==null;){if((t.f&nt)===0)return t;t=t.parent}return null}function kn(e){var t,r=ve;ct(Gs(e));try{Cn(e),t=Wn(e)}finally{ct(r)}return t}function En(e){var t=kn(e),r=(jt||(e.f&Ge)!==0)&&e.deps!==null?Lt:Le;st(e,r),e.equals(t)||(e.v=t,e.wv=Hn())}const pr=new Map;function Ye(e,t){var r={f:0,v:e,reactions:null,equals:mn,rv:0,wv:0};return r}function A(e,t){const r=Ye(e);return zn(r),r}function Tn(e,t=!1){var a;const r=Ye(e);return t||(r.equals=$a),ir&&ge!==null&&ge.l!==null&&((a=ge.l).s??(a.s=[])).push(r),r}function l(e,t,r=!1){he!==null&&!rt&&qr()&&(he.f&(nt|ea))!==0&&!(Re!=null&&Re.includes(e))&&qs();let a=r?pe(t):t;return ba(e,a)}function ba(e,t){if(!e.equals(t)){var r=e.v;jr?pr.set(e,t):pr.set(e,r),e.v=t,(e.f&nt)!==0&&((e.f&lt)!==0&&kn(e),st(e,(e.f&Ge)===0?Le:Lt)),e.wv=Hn(),Sn(e,lt),qr()&&ve!==null&&(ve.f&Le)!==0&&(ve.f&(Ct|sr))===0&&(Ue===null?ri([e]):Ue.push(e))}return t}function Sn(e,t){var r=e.reactions;if(r!==null)for(var a=qr(),n=r.length,s=0;s<n;s++){var o=r[s],c=o.f;(c&lt)===0&&(!a&&o===ve||(st(o,t),(c&(Le|Ge))!==0&&((c&nt)!==0?Sn(o,Lt):oa(o))))}}let Js=!1;var Ua,Hr,qn,On,jn;function Us(){if(Ua===void 0){Ua=window,Hr=document,qn=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;On=Ut(t,"firstChild").get,jn=Ut(t,"nextSibling").get,Va(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Va(r)&&(r.__t=void 0)}}function ra(e=""){return document.createTextNode(e)}function ot(e){return On.call(e)}function aa(e){return jn.call(e)}function v(e,t){return ot(e)}function He(e,t){{var r=ot(e);return r instanceof Comment&&r.data===""?aa(r):r}}function g(e,t=1,r=!1){let a=e;for(;t--;)a=aa(a);return a}function Zs(e){e.textContent=""}function An(e){ve===null&&he===null&&Cs(),he!==null&&(he.f&Ge)!==0&&ve===null&&xs(),jr&&ms()}function Ys(e,t){var r=t.last;r===null?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}function or(e,t,r,a=!0){var n=ve,s={ctx:ge,deps:null,nodes_start:null,nodes_end:null,f:e|lt,first:null,fn:t,last:null,next:null,parent:n,prev:null,teardown:null,transitions:null,wv:0};if(r)try{Fa(s),s.f|=yn}catch(u){throw mt(s),u}else t!==null&&oa(s);var o=r&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(wn|zr))===0;if(!o&&a&&(n!==null&&Ys(s,n),he!==null&&(he.f&nt)!==0)){var c=he;(c.effects??(c.effects=[])).push(s)}return s}function Ks(){return he!==null&&!rt}function $n(e){const t=or(Qr,null,!1);return st(t,Le),t.teardown=e,t}function $e(e){An();var t=ve!==null&&(ve.f&Ct)!==0&&ge!==null&&!ge.m;if(t){var r=ge;(r.e??(r.e=[])).push({fn:e,effect:ve,reaction:he})}else{var a=Ht(e);return a}}function Xs(e){return An(),Or(e)}function Qs(e){const t=or(sr,e,!0);return(r={})=>new Promise(a=>{r.outro?Br(t,()=>{mt(t),a(void 0)}):(mt(t),a(void 0))})}function Ht(e){return or(bn,e,!1)}function Or(e){return or(Qr,e,!0)}function J(e,t=[],r=er){const a=t.map(r);return na(()=>e(...a.map(i)))}function na(e,t=0){return or(Qr|ea|t,e,!0)}function tr(e,t=!0){return or(Qr|Ct,e,!0,t)}function Dn(e){var t=e.teardown;if(t!==null){const r=jr,a=he;Ya(!0),Xe(null);try{t.call(null)}finally{Ya(r),Xe(a)}}}function Pn(e,t=!1){var r=e.first;for(e.first=e.last=null;r!==null;){var a=r.next;(r.f&sr)!==0?r.parent=null:mt(r,t),r=a}}function ei(e){for(var t=e.first;t!==null;){var r=t.next;(t.f&Ct)===0&&mt(t),t=r}}function mt(e,t=!0){var r=!1;(t||(e.f&gs)!==0)&&e.nodes_start!==null&&(Rn(e.nodes_start,e.nodes_end),r=!0),Pn(e,t&&!r),Ur(e,0),st(e,ta);var a=e.transitions;if(a!==null)for(const s of a)s.stop();Dn(e);var n=e.parent;n!==null&&n.first!==null&&Mn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=null}function Rn(e,t){for(;e!==null;){var r=e===t?null:aa(e);e.remove(),e=r}}function Mn(e){var t=e.parent,r=e.prev,a=e.next;r!==null&&(r.next=a),a!==null&&(a.prev=r),t!==null&&(t.first===e&&(t.first=a),t.last===e&&(t.last=r))}function Br(e,t){var r=[];Ma(e,r,!0),Fn(r,()=>{mt(e),t&&t()})}function Fn(e,t){var r=e.length;if(r>0){var a=()=>--r||t();for(var n of e)n.out(a)}else t()}function Ma(e,t,r){if((e.f&yt)===0){if(e.f^=yt,e.transitions!==null)for(const o of e.transitions)(o.is_global||r)&&t.push(o);for(var a=e.first;a!==null;){var n=a.next,s=(a.f&Sr)!==0||(a.f&Ct)!==0;Ma(a,t,s?r:!1),a=n}}}function Wr(e){In(e,!0)}function In(e,t){if((e.f&yt)!==0){e.f^=yt,(e.f&Le)===0&&(e.f^=Le),Ar(e)&&(st(e,lt),oa(e));for(var r=e.first;r!==null;){var a=r.next,n=(r.f&Sr)!==0||(r.f&Ct)!==0;In(r,n?t:!1),r=a}if(e.transitions!==null)for(const s of e.transitions)(s.is_global||t)&&s.in()}}let _r=[],ya=[];function Nn(){var e=_r;_r=[],Nr(e)}function ti(){var e=ya;ya=[],Nr(e)}function sa(e){_r.length===0&&queueMicrotask(Nn),_r.push(e)}function Za(){_r.length>0&&Nn(),ya.length>0&&ti()}let Rr=!1,Vr=!1,Gr=null,zt=!1,jr=!1;function Ya(e){jr=e}let vr=[];let he=null,rt=!1;function Xe(e){he=e}let ve=null;function ct(e){ve=e}let Re=null;function zn(e){he!==null&&he.f&ga&&(Re===null?Re=[e]:Re.push(e))}let Pe=null,Ve=0,Ue=null;function ri(e){Ue=e}let Ln=1,Jr=0,jt=!1;function Hn(){return++Ln}function Ar(e){var _;var t=e.f;if((t&lt)!==0)return!0;if((t&Lt)!==0){var r=e.deps,a=(t&Ge)!==0;if(r!==null){var n,s,o=(t&Lr)!==0,c=a&&ve!==null&&!jt,u=r.length;if(o||c){var f=e,p=f.parent;for(n=0;n<u;n++)s=r[n],(o||!((_=s==null?void 0:s.reactions)!=null&&_.includes(f)))&&(s.reactions??(s.reactions=[])).push(f);o&&(f.f^=Lr),c&&p!==null&&(p.f&Ge)===0&&(f.f^=Ge)}for(n=0;n<u;n++)if(s=r[n],Ar(s)&&En(s),s.wv>e.wv)return!0}(!a||ve!==null&&!jt)&&st(e,Le)}return!1}function ai(e,t){for(var r=t;r!==null;){if((r.f&zr)!==0)try{r.fn(e);return}catch{r.f^=zr}r=r.parent}throw Rr=!1,e}function Ka(e){return(e.f&ta)===0&&(e.parent===null||(e.parent.f&zr)===0)}function ia(e,t,r,a){if(Rr){if(r===null&&(Rr=!1),Ka(t))throw e;return}if(r!==null&&(Rr=!0),ai(e,t),Ka(t))throw e}function Bn(e,t,r=!0){var a=e.reactions;if(a!==null)for(var n=0;n<a.length;n++){var s=a[n];Re!=null&&Re.includes(e)||((s.f&nt)!==0?Bn(s,t,!1):t===s&&(r?st(s,lt):(s.f&Le)!==0&&st(s,Lt),oa(s)))}}function Wn(e){var h;var t=Pe,r=Ve,a=Ue,n=he,s=jt,o=Re,c=ge,u=rt,f=e.f;Pe=null,Ve=0,Ue=null,jt=(f&Ge)!==0&&(rt||!zt||he===null),he=(f&(Ct|sr))===0?e:null,Re=null,Ga(e.ctx),rt=!1,Jr++,e.f|=ga;try{var p=(0,e.fn)(),_=e.deps;if(Pe!==null){var d;if(Ur(e,Ve),_!==null&&Ve>0)for(_.length=Ve+Pe.length,d=0;d<Pe.length;d++)_[Ve+d]=Pe[d];else e.deps=_=Pe;if(!jt)for(d=Ve;d<_.length;d++)((h=_[d]).reactions??(h.reactions=[])).push(e)}else _!==null&&Ve<_.length&&(Ur(e,Ve),_.length=Ve);if(qr()&&Ue!==null&&!rt&&_!==null&&(e.f&(nt|Lt|lt))===0)for(d=0;d<Ue.length;d++)Bn(Ue[d],e);return n!==null&&n!==e&&(Jr++,Ue!==null&&(a===null?a=Ue:a.push(...Ue))),p}finally{Pe=t,Ve=r,Ue=a,he=n,jt=s,Re=o,Ga(c),rt=u,e.f^=ga}}function ni(e,t){let r=t.reactions;if(r!==null){var a=ds.call(r,e);if(a!==-1){var n=r.length-1;n===0?r=t.reactions=null:(r[a]=r[n],r.pop())}}r===null&&(t.f&nt)!==0&&(Pe===null||!Pe.includes(t))&&(st(t,Lt),(t.f&(Ge|Lr))===0&&(t.f^=Lr),Cn(t),Ur(t,0))}function Ur(e,t){var r=e.deps;if(r!==null)for(var a=t;a<r.length;a++)ni(e,r[a])}function Fa(e){var t=e.f;if((t&ta)===0){st(e,Le);var r=ve,a=ge,n=zt;ve=e,zt=!0;try{(t&ea)!==0?ei(e):Pn(e),Dn(e);var s=Wn(e);e.teardown=typeof s=="function"?s:null,e.wv=Ln;var o=e.deps,c;Wa&&Os&&e.f&lt}catch(u){ia(u,e,r,a||e.ctx)}finally{zt=n,ve=r}}}function si(){try{ks()}catch(e){if(Gr!==null)ia(e,Gr,null);else throw e}}function Vn(){var e=zt;try{var t=0;for(zt=!0;vr.length>0;){t++>1e3&&si();var r=vr,a=r.length;vr=[];for(var n=0;n<a;n++){var s=oi(r[n]);ii(s)}pr.clear()}}finally{Vr=!1,zt=e,Gr=null}}function ii(e){var t=e.length;if(t!==0)for(var r=0;r<t;r++){var a=e[r];if((a.f&(ta|yt))===0)try{Ar(a)&&(Fa(a),a.deps===null&&a.first===null&&a.nodes_start===null&&(a.teardown===null?Mn(a):a.fn=null))}catch(n){ia(n,a,null,a.ctx)}}}function oa(e){Vr||(Vr=!0,queueMicrotask(Vn));for(var t=Gr=e;t.parent!==null;){t=t.parent;var r=t.f;if((r&(sr|Ct))!==0){if((r&Le)===0)return;t.f^=Le}}vr.push(t)}function oi(e){for(var t=[],r=e;r!==null;){var a=r.f,n=(a&(Ct|sr))!==0,s=n&&(a&Le)!==0;if(!s&&(a&yt)===0){if((a&bn)!==0)t.push(r);else if(n)r.f^=Le;else try{Ar(r)&&Fa(r)}catch(u){ia(u,r,null,r.ctx)}var o=r.first;if(o!==null){r=o;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)r=c.next,c=c.parent}return t}function li(e){var t;for(Za();vr.length>0;)Vr=!0,Vn(),Za();return t}async function ci(){await Promise.resolve(),li()}function i(e){var t=e.f,r=(t&nt)!==0;if(he!==null&&!rt){if(!(Re!=null&&Re.includes(e))){var a=he.deps;e.rv<Jr&&(e.rv=Jr,Pe===null&&a!==null&&a[Ve]===e?Ve++:Pe===null?Pe=[e]:(!jt||!Pe.includes(e))&&Pe.push(e))}}else if(r&&e.deps===null&&e.effects===null){var n=e,s=n.parent;s!==null&&(s.f&Ge)===0&&(n.f^=Ge)}return r&&(n=e,Ar(n)&&En(n)),jr&&pr.has(e)?pr.get(e):e.v}function xt(e){var t=rt;try{return rt=!0,e()}finally{rt=t}}const di=-7169;function st(e,t){e.f=e.f&di|t}function vi(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(wt in e)wa(e);else if(!Array.isArray(e))for(let t in e){const r=e[t];typeof r=="object"&&r&&wt in r&&wa(r)}}}function wa(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let a in e)try{wa(e[a],t)}catch{}const r=Aa(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const a=gn(r);for(let n in a){const s=a[n].get;if(s)try{s.call(e)}catch{}}}}}const ui=["touchstart","touchmove"];function fi(e){return ui.includes(e)}let Xa=!1;function hi(){Xa||(Xa=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var t;if(!e.defaultPrevented)for(const r of e.target.elements)(t=r.__on_r)==null||t.call(r)})},{capture:!0}))}function Ia(e){var t=he,r=ve;Xe(null),ct(null);try{return e()}finally{Xe(t),ct(r)}}function Gn(e,t,r,a=r){e.addEventListener(t,()=>Ia(r));const n=e.__on_r;n?e.__on_r=()=>{n(),a(!0)}:e.__on_r=()=>a(!0),hi()}const Jn=new Set,ma=new Set;function Un(e,t,r,a={}){function n(s){if(a.capture||cr.call(t,s),!s.cancelBubble)return Ia(()=>r==null?void 0:r.call(this,s))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?sa(()=>{t.addEventListener(e,n,a)}):t.addEventListener(e,n,a),n}function Qa(e,t,r,a={}){var n=Un(t,e,r,a);return()=>{e.removeEventListener(t,n,a)}}function dt(e,t,r,a,n){var s={capture:a,passive:n},o=Un(e,t,r,s);(t===document.body||t===window||t===document)&&$n(()=>{t.removeEventListener(e,o,s)})}function vt(e){for(var t=0;t<e.length;t++)Jn.add(e[t]);for(var r of ma)r(e)}function cr(e){var F;var t=this,r=t.ownerDocument,a=e.type,n=((F=e.composedPath)==null?void 0:F.call(e))||[],s=n[0]||e.target,o=0,c=e.__root;if(c){var u=n.indexOf(c);if(u!==-1&&(t===document||t===window)){e.__root=t;return}var f=n.indexOf(t);if(f===-1)return;u<=f&&(o=u)}if(s=n[o]||e.target,s!==t){vs(e,"currentTarget",{configurable:!0,get(){return s||r}});var p=he,_=ve;Xe(null),ct(null);try{for(var d,h=[];s!==null;){var b=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+a];if(w!=null&&(!s.disabled||e.target===s))if(Oa(w)){var[q,...R]=w;q.apply(s,[e,...R])}else w.call(s,e)}catch($){d?h.push($):d=$}if(e.cancelBubble||b===t||b===null)break;s=b}if(d){for(let $ of h)queueMicrotask(()=>{throw $});throw d}}finally{e.__root=t,delete e.currentTarget,Xe(p),ct(_)}}}function Na(e){var t=document.createElement("template");return t.innerHTML=e,t.content}function rr(e,t){var r=ve;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=t)}function C(e,t){var r=(t&Ls)!==0,a=(t&Hs)!==0,n,s=!e.startsWith("<!>");return()=>{n===void 0&&(n=Na(s?e:"<!>"+e),r||(n=ot(n)));var o=a||qn?document.importNode(n,!0):n.cloneNode(!0);if(r){var c=ot(o),u=o.lastChild;rr(c,u)}else rr(o,o);return o}}function $r(e,t,r="svg"){var a=!e.startsWith("<!>"),n=`<${r}>${a?e:"<!>"+e}</${r}>`,s;return()=>{if(!s){var o=Na(n),c=ot(o);s=ot(c)}var u=s.cloneNode(!0);return rr(u,u),u}}function Ce(e=""){{var t=ra(e+"");return rr(t,t),t}}function ar(){var e=document.createDocumentFragment(),t=document.createComment(""),r=ra();return e.append(t,r),rr(t,r),e}function y(e,t){e!==null&&e.before(t)}let xa=!0;function X(e,t){var r=t==null?"":typeof t=="object"?t+"":t;r!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=r,e.nodeValue=r+"")}function pi(e,t){return _i(e,t)}const Gt=new Map;function _i(e,{target:t,anchor:r,props:a={},events:n,context:s,intro:o=!0}){Us();var c=new Set,u=_=>{for(var d=0;d<_.length;d++){var h=_[d];if(!c.has(h)){c.add(h);var b=fi(h);t.addEventListener(h,cr,{passive:b});var w=Gt.get(h);w===void 0?(document.addEventListener(h,cr,{passive:b}),Gt.set(h,1)):Gt.set(h,w+1)}}};u(ja(Jn)),ma.add(u);var f=void 0,p=Qs(()=>{var _=r??t.appendChild(ra());return tr(()=>{if(s){Ee({});var d=ge;d.c=s}n&&(a.$$events=n),xa=o,f=e(_,a)||{},xa=!0,s&&Te()}),()=>{var b;for(var d of c){t.removeEventListener(d,cr);var h=Gt.get(d);--h===0?(document.removeEventListener(d,cr),Gt.delete(d)):Gt.set(d,h)}ma.delete(u),_!==r&&((b=_.parentNode)==null||b.removeChild(_))}});return gi.set(f,p),f}let gi=new WeakMap;function I(e,t,[r,a]=[0,0]){var n=e,s=null,o=null,c=ze,u=r>0?Sr:0,f=!1;const p=(d,h=!0)=>{f=!0,_(h,d)},_=(d,h)=>{c!==(c=d)&&(c?(s?Wr(s):h&&(s=tr(()=>h(n))),o&&Br(o,()=>{o=null})):(o?Wr(o):h&&(o=tr(()=>h(n,[r+1,a]))),s&&Br(s,()=>{s=null})))};na(()=>{f=!1,t(p),f||_(null,null)},u)}function Qe(e,t){return t}function bi(e,t,r,a){for(var n=[],s=t.length,o=0;o<s;o++)Ma(t[o].e,n,!0);var c=s>0&&n.length===0&&r!==null;if(c){var u=r.parentNode;Zs(u),u.append(r),a.clear(),St(e,t[0].prev,t[s-1].next)}Fn(n,()=>{for(var f=0;f<s;f++){var p=t[f];c||(a.delete(p.k),St(e,p.prev,p.next)),mt(p.e,!c)}})}function Me(e,t,r,a,n,s=null){var o=e,c={flags:t,items:new Map,first:null},u=(t&xn)!==0;if(u){var f=e;o=f.appendChild(ra())}var p=null,_=!1,d=Ra(()=>{var h=r();return Oa(h)?h:h==null?[]:ja(h)});na(()=>{var h=i(d),b=h.length;_&&b===0||(_=b===0,yi(h,c,o,n,t,a,r),s!==null&&(b===0?p?Wr(p):p=tr(()=>s(o)):p!==null&&Br(p,()=>{p=null})),i(d))})}function yi(e,t,r,a,n,s,o){var P,D,m,M;var c=(n&As)!==0,u=(n&(Da|Pa))!==0,f=e.length,p=t.items,_=t.first,d=_,h,b=null,w,q=[],R=[],F,$,k,E;if(c)for(E=0;E<f;E+=1)F=e[E],$=s(F,E),k=p.get($),k!==void 0&&((P=k.a)==null||P.measure(),(w??(w=new Set)).add(k));for(E=0;E<f;E+=1){if(F=e[E],$=s(F,E),k=p.get($),k===void 0){var W=d?d.e.nodes_start:r;b=mi(W,t,b,b===null?t.first:b.next,F,$,E,a,n,o),p.set($,b),q=[],R=[],d=b.next;continue}if(u&&wi(k,F,E,n),(k.e.f&yt)!==0&&(Wr(k.e),c&&((D=k.a)==null||D.unfix(),(w??(w=new Set)).delete(k))),k!==d){if(h!==void 0&&h.has(k)){if(q.length<R.length){var B=R[0],Z;b=B.prev;var L=q[0],V=q[q.length-1];for(Z=0;Z<q.length;Z+=1)en(q[Z],B,r);for(Z=0;Z<R.length;Z+=1)h.delete(R[Z]);St(t,L.prev,V.next),St(t,b,L),St(t,V,B),d=B,b=V,E-=1,q=[],R=[]}else h.delete(k),en(k,d,r),St(t,k.prev,k.next),St(t,k,b===null?t.first:b.next),St(t,b,k),b=k;continue}for(q=[],R=[];d!==null&&d.k!==$;)(d.e.f&yt)===0&&(h??(h=new Set)).add(d),R.push(d),d=d.next;if(d===null)continue;k=d}q.push(k),b=k,d=k.next}if(d!==null||h!==void 0){for(var re=h===void 0?[]:ja(h);d!==null;)(d.e.f&yt)===0&&re.push(d),d=d.next;var ae=re.length;if(ae>0){var ie=(n&xn)!==0&&f===0?r:null;if(c){for(E=0;E<ae;E+=1)(m=re[E].a)==null||m.measure();for(E=0;E<ae;E+=1)(M=re[E].a)==null||M.fix()}bi(t,re,ie,p)}}c&&sa(()=>{var T;if(w!==void 0)for(k of w)(T=k.a)==null||T.apply()}),ve.first=t.first&&t.first.e,ve.last=b&&b.e}function wi(e,t,r,a){(a&Da)!==0&&ba(e.v,t),(a&Pa)!==0?ba(e.i,r):e.i=r}function mi(e,t,r,a,n,s,o,c,u,f){var p=(u&Da)!==0,_=(u&$s)===0,d=p?_?Tn(n):Ye(n):n,h=(u&Pa)===0?o:Ye(o),b={i:h,v:d,k:s,a:null,e:null,prev:r,next:a};try{return b.e=tr(()=>c(e,d,h,f),Js),b.e.prev=r&&r.e,b.e.next=a&&a.e,r===null?t.first=b:(r.next=b,r.e.next=b.e),a!==null&&(a.prev=b,a.e.prev=b.e),b}finally{}}function en(e,t,r){for(var a=e.next?e.next.e.nodes_start:r,n=t?t.e.nodes_start:r,s=e.e.nodes_start;s!==a;){var o=aa(s);n.before(s),s=o}}function St(e,t,r){t===null?e.first=r:(t.next=r,t.e.next=r&&r.e),r!==null&&(r.prev=t,r.e.prev=t&&t.e)}function nr(e,t,r=!1,a=!1,n=!1){var s=e,o="";J(()=>{var c=ve;if(o!==(o=t()??"")&&(c.nodes_start!==null&&(Rn(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),o!=="")){var u=o+"";r?u=`<svg>${u}</svg>`:a&&(u=`<math>${u}</math>`);var f=Na(u);if((r||a)&&(f=ot(f)),rr(ot(f),f.lastChild),r||a)for(;ot(f);)s.before(ot(f));else s.before(f)}})}function gr(e,t,...r){var a=e,n=pt,s;na(()=>{n!==(n=t())&&(s&&(mt(s),s=null),s=tr(()=>n(a,...r)))},Sr)}function Zn(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var n=e.length;for(t=0;t<n;t++)e[t]&&(r=Zn(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function xi(){for(var e,t,r=0,a="",n=arguments.length;r<n;r++)(e=arguments[r])&&(t=Zn(e))&&(a&&(a+=" "),a+=t);return a}function ur(e){return typeof e=="object"?xi(e):e??""}const tn=[...` 	
\r\f¬†\v\uFEFF`];function Ci(e,t,r){var a=e==null?"":""+e;if(t&&(a=a?a+" "+t:t),r){for(var n in r)if(r[n])a=a?a+" "+n:n;else if(a.length)for(var s=n.length,o=0;(o=a.indexOf(n,o))>=0;){var c=o+s;(o===0||tn.includes(a[o-1]))&&(c===a.length||tn.includes(a[c]))?a=(o===0?"":a.substring(0,o))+a.substring(c+1):o=c}}return a===""?null:a}function rn(e,t=!1){var r=t?" !important;":";",a="";for(var n in e){var s=e[n];s!=null&&s!==""&&(a+=" "+n+": "+s+r)}return a}function va(e){return e[0]!=="-"||e[1]!=="-"?e.toLowerCase():e}function ki(e,t){if(t){var r="",a,n;if(Array.isArray(t)?(a=t[0],n=t[1]):a=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,o=0,c=!1,u=[];a&&u.push(...Object.keys(a).map(va)),n&&u.push(...Object.keys(n).map(va));var f=0,p=-1;const w=e.length;for(var _=0;_<w;_++){var d=e[_];if(c?d==="/"&&e[_-1]==="*"&&(c=!1):s?s===d&&(s=!1):d==="/"&&e[_+1]==="*"?c=!0:d==='"'||d==="'"?s=d:d==="("?o++:d===")"&&o--,!c&&s===!1&&o===0){if(d===":"&&p===-1)p=_;else if(d===";"||_===w-1){if(p!==-1){var h=va(e.substring(f,p).trim());if(!u.includes(h)){d!==";"&&_++;var b=e.substring(f,_).trim();r+=" "+b+";"}}f=_+1,p=-1}}}}return a&&(r+=rn(a)),n&&(r+=rn(n,!0)),r=r.trim(),r===""?null:r}return e==null?null:String(e)}function ke(e,t,r,a,n,s){var o=e.__className;if(o!==r||o===void 0){var c=Ci(r,a,s);c==null?e.removeAttribute("class"):t?e.className=c:e.setAttribute("class",c),e.__className=r}else if(s&&n!==s)for(var u in s){var f=!!s[u];(n==null||f!==!!n[u])&&e.classList.toggle(u,f)}return s}function ua(e,t={},r,a){for(var n in r){var s=r[n];t[n]!==s&&(r[n]==null?e.style.removeProperty(n):e.style.setProperty(n,s,a))}}function Fe(e,t,r,a){var n=e.__style;if(n!==t){var s=ki(t,a);s==null?e.removeAttribute("style"):e.style.cssText=s,e.__style=t}else a&&(Array.isArray(a)?(ua(e,r==null?void 0:r[0],a[0]),ua(e,r==null?void 0:r[1],a[1],"important")):ua(e,r,a));return a}const Ei=Symbol("is custom element"),Ti=Symbol("is html");function Ze(e,t,r,a){var n=Si(e);n[t]!==(n[t]=r)&&(t==="loading"&&(e[ys]=r),r==null?e.removeAttribute(t):typeof r!="string"&&qi(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function Si(e){return e.__attributes??(e.__attributes={[Ei]:e.nodeName.includes("-"),[Ti]:e.namespaceURI===Bs})}var an=new Map;function qi(e){var t=an.get(e.nodeName);if(t)return t;an.set(e.nodeName,t=[]);for(var r,a=e,n=Element.prototype;n!==a;){r=gn(a);for(var s in r)r[s].set&&t.push(s);a=Aa(a)}return t}const Oi=()=>performance.now(),it={tick:e=>requestAnimationFrame(e),now:()=>Oi(),tasks:new Set};function Yn(){const e=it.now();it.tasks.forEach(t=>{t.c(e)||(it.tasks.delete(t),t.f())}),it.tasks.size!==0&&it.tick(Yn)}function Kn(e){let t;return it.tasks.size===0&&it.tick(Yn),{promise:new Promise(r=>{it.tasks.add(t={c:e,f:r})}),abort(){it.tasks.delete(t)}}}function Dr(e,t){Ia(()=>{e.dispatchEvent(new CustomEvent(t))})}function ji(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const t=e.split("-");return t.length===1?t[0]:t[0]+t.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function nn(e){const t={},r=e.split(";");for(const a of r){const[n,s]=a.split(":");if(!n||s===void 0)break;const o=ji(n.trim());t[o]=s.trim()}return t}const Ai=e=>e;function br(e,t,r,a){var n=(e&Is)!==0,s=(e&Ns)!==0,o=n&&s,c=(e&zs)!==0,u=o?"both":n?"in":"out",f,p=t.inert,_=t.style.overflow,d,h;function b(){var $=he,k=ve;Xe(null),ct(null);try{return f??(f=r()(t,(a==null?void 0:a())??{},{direction:u}))}finally{Xe($),ct(k)}}var w={is_global:c,in(){var $;if(t.inert=p,!n){h==null||h.abort(),($=h==null?void 0:h.reset)==null||$.call(h);return}s||d==null||d.abort(),Dr(t,"introstart"),d=Ca(t,b(),h,1,()=>{Dr(t,"introend"),d==null||d.abort(),d=f=void 0,t.style.overflow=_})},out($){if(!s){$==null||$(),f=void 0;return}t.inert=!0,Dr(t,"outrostart"),h=Ca(t,b(),d,0,()=>{Dr(t,"outroend"),$==null||$()})},stop:()=>{d==null||d.abort(),h==null||h.abort()}},q=ve;if((q.transitions??(q.transitions=[])).push(w),n&&xa){var R=c;if(!R){for(var F=q.parent;F&&(F.f&Sr)!==0;)for(;(F=F.parent)&&(F.f&ea)===0;);R=!F||(F.f&yn)!==0}R&&Ht(()=>{xt(()=>w.in())})}}function Ca(e,t,r,a,n){var s=a===1;if(hs(t)){var o,c=!1;return sa(()=>{if(!c){var q=t({direction:s?"in":"out"});o=Ca(e,q,r,a,n)}}),{abort:()=>{c=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(r==null||r.deactivate(),!(t!=null&&t.duration))return n(),{abort:pt,deactivate:pt,reset:pt,t:()=>a};const{delay:u=0,css:f,tick:p,easing:_=Ai}=t;var d=[];if(s&&r===void 0&&(p&&p(0,1),f)){var h=nn(f(0,1));d.push(h,h)}var b=()=>1-a,w=e.animate(d,{duration:u});return w.onfinish=()=>{var q=(r==null?void 0:r.t())??1-a;r==null||r.abort();var R=a-q,F=t.duration*Math.abs(R),$=[];if(F>0){var k=!1;if(f)for(var E=Math.ceil(F/16.666666666666668),W=0;W<=E;W+=1){var B=q+R*_(W/E),Z=nn(f(B,1-B));$.push(Z),k||(k=Z.overflow==="hidden")}k&&(e.style.overflow="hidden"),b=()=>{var L=w.currentTime;return q+R*_(L/F)},p&&Kn(()=>{if(w.playState!=="running")return!1;var L=b();return p(L,1-L),!0})}w=e.animate($,{duration:F,fill:"forwards"}),w.onfinish=()=>{b=()=>a,p==null||p(a,1-a),n()}},{abort:()=>{w&&(w.cancel(),w.effect=null,w.onfinish=pt)},deactivate:()=>{n=pt},reset:()=>{a===0&&(p==null||p(1,0))},t:()=>b()}}function Ke(e,t,r=t){var a=qr();Gn(e,"input",n=>{var s=n?e.defaultValue:e.value;if(s=fa(e)?ha(s):s,r(s),a&&s!==(s=t())){var o=e.selectionStart,c=e.selectionEnd;e.value=s??"",c!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(c,e.value.length))}}),xt(t)==null&&e.value&&r(fa(e)?ha(e.value):e.value),Or(()=>{var n=t();fa(e)&&n===ha(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function fa(e){var t=e.type;return t==="number"||t==="range"}function ha(e){return e===""?null:+e}function Xn(e,t,r){if(e.multiple)return Di(e,t);for(var a of e.options){var n=fr(a);if(Vs(n,t)){a.selected=!0;return}}(!r||t!==void 0)&&(e.selectedIndex=-1)}function $i(e,t){Ht(()=>{var r=new MutationObserver(()=>{var a=e.__value;Xn(e,a)});return r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function Qn(e,t,r=t){var a=!0;Gn(e,"change",n=>{var s=n?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(s),fr);else{var c=e.querySelector(s)??e.querySelector("option:not([disabled])");o=c&&fr(c)}r(o)}),Ht(()=>{var n=t();if(Xn(e,n,a),a&&n===void 0){var s=e.querySelector(":checked");s!==null&&(n=fr(s),r(n))}e.__value=n,a=!1}),$i(e)}function Di(e,t){for(var r of e.options)r.selected=~t.indexOf(fr(r))}function fr(e){return"__value"in e?e.__value:e.value}var qt,Yt,yr,Zr,es;const Yr=class Yr{constructor(t){_e(this,Zr);_e(this,qt,new WeakMap);_e(this,Yt);_e(this,yr);Rt(this,yr,t)}observe(t,r){var a=G(this,qt).get(t)||new Set;return a.add(r),G(this,qt).set(t,a),Tt(this,Zr,es).call(this).observe(t,G(this,yr)),()=>{var n=G(this,qt).get(t);n.delete(r),n.size===0&&(G(this,qt).delete(t),G(this,Yt).unobserve(t))}}};qt=new WeakMap,Yt=new WeakMap,yr=new WeakMap,Zr=new WeakSet,es=function(){return G(this,Yt)??Rt(this,Yt,new ResizeObserver(t=>{for(var r of t){Yr.entries.set(r.target,r);for(var a of G(this,qt).get(r.target)||[])a(r)}}))},lr(Yr,"entries",new WeakMap);let ka=Yr;var Pi=new ka({box:"border-box"});function Ri(e,t,r){var a=Pi.observe(e,()=>r(e[t]));Ht(()=>(xt(()=>r(e[t])),a))}function sn(e,t){return e===t||(e==null?void 0:e[wt])===t}function At(e={},t,r,a){return Ht(()=>{var n,s;return Or(()=>{n=s,s=(a==null?void 0:a())||[],xt(()=>{e!==r(...s)&&(t(e,...s),n&&sn(r(...n),e)&&t(null,...n))})}),()=>{sa(()=>{s&&sn(r(...s),e)&&t(null,...s)})}}),e}function Mi(e=!1){const t=ge,r=t.l.u;if(!r)return;let a=()=>vi(t.s);if(e){let n=0,s={};const o=er(()=>{let c=!1;const u=t.s;for(const f in u)u[f]!==s[f]&&(s[f]=u[f],c=!0);return c&&n++,n});a=()=>i(o)}r.b.length&&Xs(()=>{on(t,a),Nr(r.b)}),$e(()=>{const n=xt(()=>r.m.map(ps));return()=>{for(const s of n)typeof s=="function"&&s()}}),r.a.length&&$e(()=>{on(t,a),Nr(r.a)})}function on(e,t){if(e.l.s)for(const r of e.l.s)i(r);t()}function Fi(e){var t=Ye(0);return function(){return arguments.length===1?(l(t,i(t)+1),arguments[0]):(i(t),e())}}let Pr=!1;function Ii(e){var t=Pr;try{return Pr=!1,[e(),Pr]}finally{Pr=t}}function ln(e){var t;return((t=e.ctx)==null?void 0:t.d)??!1}function se(e,t,r,a){var W;var n=(r&Ds)!==0,s=!ir||(r&Ps)!==0,o=(r&Ms)!==0,c=(r&Fs)!==0,u=!1,f;o?[f,u]=Ii(()=>e[t]):f=e[t];var p=wt in e||bs in e,_=o&&(((W=Ut(e,t))==null?void 0:W.set)??(p&&t in e&&(B=>e[t]=B)))||void 0,d=a,h=!0,b=!1,w=()=>(b=!0,h&&(h=!1,c?d=xt(a):d=a),d);f===void 0&&a!==void 0&&(_&&s&&Es(),f=w(),_&&_(f));var q;if(s)q=()=>{var B=e[t];return B===void 0?w():(h=!0,b=!1,B)};else{var R=(n?er:Ra)(()=>e[t]);R.f|=_s,q=()=>{var B=i(R);return B!==void 0&&(d=void 0),B===void 0?d:B}}if((r&Rs)===0)return q;if(_){var F=e.$$legacy;return function(B,Z){return arguments.length>0?((!s||!Z||F||u)&&_(Z?q():B),B):q()}}var $=!1,k=Tn(f),E=er(()=>{var B=q(),Z=i(k);return $?($=!1,Z):k.v=B});return o&&i(E),n||(E.equals=$a),function(B,Z){if(arguments.length>0){const L=Z?i(E):s&&o?pe(B):B;if(!E.equals(L)){if($=!0,l(k,L),b&&d!==void 0&&(d=L),ln(E))return B;xt(()=>i(E))}return B}return ln(E)?E.v:i(E)}}function ts(e){ge===null&&Ws(),ir&&ge.l!==null?Ni(ge).m.push(e):$e(()=>{const t=xt(e);if(typeof t=="function")return t})}function Ni(e){var t=e.l;return t.u??(t.u={a:[],b:[],m:[]})}const zi="5";var _n;typeof window<"u"&&((_n=window.__svelte??(window.__svelte={})).v??(_n.v=new Set)).add(zi);var Li=C('<div class="btn-spinner svelte-1230vvt"><div class="spinner-ring svelte-1230vvt"></div></div>'),Hi=C("<button><!> <span><!></span></button>");function at(e,t){let r=se(t,"variant",3,"primary"),a=se(t,"size",3,"md"),n=se(t,"disabled",3,!1),s=se(t,"loading",3,!1),o=se(t,"fullWidth",3,!1),c=se(t,"glowing",3,!1),u=se(t,"type",3,"button");const f=me(()=>n()||s());var p=Hi();let _;p.__click=function(...R){var F;(F=t.onclick)==null||F.apply(this,R)};var d=v(p);{var h=R=>{var F=Li();y(R,F)};I(d,R=>{s()&&R(h)})}var b=g(d,2);let w;var q=v(b);gr(q,()=>t.children??pt),J((R,F)=>{Ze(p,"type",u()),_=ke(p,1,`btn btn-${r()??""} btn-${a()??""}`,"svelte-1230vvt",_,R),p.disabled=i(f),w=ke(b,1,"btn-content svelte-1230vvt",null,w,F)},[()=>({"btn-full":o(),"btn-loading":s(),"btn-glow":c()&&!i(f)}),()=>({"btn-content-hidden":s()})]),y(e,p)}vt(["click"]);var Bi=C('<div class="card-progress svelte-1g43p0q"><div class="card-progress-bar svelte-1g43p0q"></div></div>'),Wi=C('<div class="card-completion-indicator svelte-1g43p0q"><svg viewBox="0 0 20 20" fill="currentColor" class="svelte-1g43p0q"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" class="svelte-1g43p0q"></path></svg></div>'),Vi=C('<button type="button"><!> <!> <div class="card-content svelte-1g43p0q"><!></div></button>'),Gi=C('<div class="card-progress svelte-1g43p0q"><div class="card-progress-bar svelte-1g43p0q"></div></div>'),Ji=C('<div class="card-completion-indicator svelte-1g43p0q"><svg viewBox="0 0 20 20" fill="currentColor" class="svelte-1g43p0q"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" class="svelte-1g43p0q"></path></svg></div>'),Ui=C('<div><!> <!> <div class="card-content svelte-1g43p0q"><!></div></div>');function _t(e,t){let r=se(t,"variant",3,"default"),a=se(t,"padding",3,"md"),n=se(t,"glowing",3,!1),s=se(t,"clickable",3,!1),o=se(t,"completed",3,!1);const c=me(()=>s()||!!t.onclick);var u=ar(),f=He(u);{var p=d=>{var h=Vi();let b;h.__click=function(...E){var W;(W=t.onclick)==null||W.apply(this,E)};var w=v(h);{var q=E=>{var W=Bi(),B=v(W);J(()=>Fe(B,`width: ${t.progress??""}%`)),y(E,W)};I(w,E=>{t.progress!==void 0&&E(q)})}var R=g(w,2);{var F=E=>{var W=Wi();y(E,W)};I(R,E=>{o()&&E(F)})}var $=g(R,2),k=v($);gr(k,()=>t.children??pt),J(E=>b=ke(h,1,`card card-${r()??""} card-padding-${a()??""} card-clickable`,"svelte-1g43p0q",b,E),[()=>({"card-glow":n(),"card-completed":o()})]),y(d,h)},_=d=>{var h=Ui();let b;var w=v(h);{var q=E=>{var W=Gi(),B=v(W);J(()=>Fe(B,`width: ${t.progress??""}%`)),y(E,W)};I(w,E=>{t.progress!==void 0&&E(q)})}var R=g(w,2);{var F=E=>{var W=Ji();y(E,W)};I(R,E=>{o()&&E(F)})}var $=g(R,2),k=v($);gr(k,()=>t.children??pt),J(E=>b=ke(h,1,`card card-${r()??""} card-padding-${a()??""}`,"svelte-1g43p0q",b,E),[()=>({"card-glow":n(),"card-completed":o()})]),y(d,h)};I(f,d=>{i(c)?d(p):d(_,!1)})}y(e,u)}vt(["click"]);var Zi=(e,t)=>e.key==="Escape"&&t(),Yi=e=>e.stopPropagation(),Ki=e=>e.stopPropagation(),Xi=C('<span class="error-message svelte-lae1sa"> </span>'),Qi=C('<span class="error-message svelte-lae1sa"> </span>'),eo=C("<option> </option>"),to=C('<form class="create-form svelte-lae1sa"><div class="modal-header svelte-lae1sa"><h2 class="modal-title svelte-lae1sa">Create New Project</h2> <button type="button" class="close-button svelte-lae1sa" aria-label="Close modal"><svg viewBox="0 0 20 20" fill="currentColor" class="svelte-lae1sa"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div> <div class="form-fields svelte-lae1sa"><div class="field-group svelte-lae1sa"><label for="title" class="field-label svelte-lae1sa">Project Title *</label> <input id="title" type="text" placeholder="Enter your book title" required> <!></div> <div class="field-group svelte-lae1sa"><label for="author" class="field-label svelte-lae1sa">Author *</label> <input id="author" type="text" placeholder="Your name" required> <!></div> <div class="field-group svelte-lae1sa"><label for="genre" class="field-label svelte-lae1sa">Genre</label> <select id="genre" class="field-input svelte-lae1sa"><option>Select a genre (optional)</option><!></select></div> <div class="field-group svelte-lae1sa"><label for="description" class="field-label svelte-lae1sa">Description</label> <textarea id="description" class="field-input field-textarea svelte-lae1sa" placeholder="Brief description of your book (optional)" rows="3"></textarea></div></div> <div class="modal-actions svelte-lae1sa"><!> <!></div></form>'),ro=C('<div class="modal-overlay svelte-lae1sa" role="dialog" aria-modal="true"><div class="modal-container svelte-lae1sa"><!></div></div>');function ao(e,t){Ee(t,!0);let r=A(pe({title:"",author:"",genre:"",description:""})),a=A(!1),n=A(pe({}));function s(){return l(n,{},!0),i(r).title.trim()||(i(n).title="Title is required"),i(r).author.trim()||(i(n).author="Author is required"),Object.keys(i(n)).length===0}async function o(){if(s()){l(a,!0);try{const h=await fetch("/api/library/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i(r))});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const b=await h.json();c(),t.onProjectCreated?t.onProjectCreated(b):t.onClose()}catch(h){console.error("Failed to create project:",h),alert("Failed to create project. Please try again.")}finally{l(a,!1)}}}function c(){l(r,{title:"",author:"",genre:"",description:""},!0),l(n,{},!0)}function u(){t.onClose(),c()}const f=["Science Fiction","Fantasy","Mystery","Romance","Thriller","Horror","Historical Fiction","Contemporary Fiction","Young Adult","Literary Fiction","Adventure","Crime","Dystopian","Memoir"];var p=ro();p.__click=u,p.__keydown=[Zi,u];var _=v(p);_.__click=[Yi],_.__keydown=[Ki];var d=v(_);_t(d,{variant:"highlighted",padding:"lg",children:(h,b)=>{var w=to(),q=v(w),R=g(v(q),2);R.__click=u;var F=g(q,2),$=v(F),k=g(v($),2);let E;var W=g(k,2);{var B=N=>{var j=Xi(),K=v(j);J(()=>X(K,i(n).title)),y(N,j)};I(W,N=>{i(n).title&&N(B)})}var Z=g($,2),L=g(v(Z),2);let V;var re=g(L,2);{var ae=N=>{var j=Qi(),K=v(j);J(()=>X(K,i(n).author)),y(N,j)};I(re,N=>{i(n).author&&N(ae)})}var ie=g(Z,2),P=g(v(ie),2),D=v(P);D.value=D.__value="";var m=g(D);Me(m,17,()=>f,Qe,(N,j)=>{var K=eo(),le={},O=v(K);J(()=>{le!==(le=i(j))&&(K.value=(K.__value=i(j))??""),X(O,i(j))}),y(N,K)});var M=g(ie,2),T=g(v(M),2),x=g(F,2),S=v(x);at(S,{variant:"ghost",onclick:u,get disabled(){return i(a)},children:(N,j)=>{var K=Ce("Cancel");y(N,K)},$$slots:{default:!0}});var ee=g(S,2);at(ee,{type:"submit",variant:"primary",get loading(){return i(a)},get disabled(){return i(a)},children:(N,j)=>{var K=Ce("Create Project");y(N,K)},$$slots:{default:!0}}),J((N,j)=>{E=ke(k,1,"field-input svelte-lae1sa",null,E,N),V=ke(L,1,"field-input svelte-lae1sa",null,V,j)},[()=>({"field-error":i(n).title}),()=>({"field-error":i(n).author})]),dt("submit",w,N=>{N.preventDefault(),o()}),Ke(k,()=>i(r).title,N=>i(r).title=N),Ke(L,()=>i(r).author,N=>i(r).author=N),Qn(P,()=>i(r).genre,N=>i(r).genre=N),Ke(T,()=>i(r).description,N=>i(r).description=N),y(h,w)},$$slots:{default:!0}}),y(e,p),Te()}vt(["click","keydown"]);class no{constructor(){lr(this,"toasts",[]);lr(this,"subscribers",[])}subscribe(t){return this.subscribers.push(t),t(this.toasts),()=>{const r=this.subscribers.indexOf(t);r>-1&&this.subscribers.splice(r,1)}}notify(){this.subscribers.forEach(t=>t(this.toasts))}add(t){const r=Math.random().toString(36).substr(2,9),a={...t,id:r};return this.toasts=[...this.toasts,a],this.notify(),r}remove(t){this.toasts=this.toasts.filter(r=>r.id!==t),this.notify()}clear(){this.toasts=[],this.notify()}info(t,r){return this.add({message:t,type:"info",duration:r})}success(t,r){return this.add({message:t,type:"success",duration:r})}error(t,r){return this.add({message:t,type:"error",duration:r??6e3})}warning(t,r){return this.add({message:t,type:"warning",duration:r})}}const Mt=new no,qe={info:(e,t)=>Mt.info(e,t),success:(e,t)=>Mt.success(e,t),error:(e,t)=>Mt.error(e,t),warning:(e,t)=>Mt.warning(e,t),clear:()=>Mt.clear()};var so=C('<div class="loading-state svelte-1yqqw0k"><div class="loading-spinner svelte-1yqqw0k"></div> <p>Loading project status...</p></div>'),io=C('<div class="error-state svelte-1yqqw0k"><p class="error-message svelte-1yqqw0k"> </p> <!></div>'),oo=C('<div class="journey-card svelte-1yqqw0k"><div class="journey-card-header svelte-1yqqw0k"><div class="journey-number svelte-1yqqw0k"> </div> <h3 class="journey-title svelte-1yqqw0k"> </h3></div> <p class="journey-description svelte-1yqqw0k"> </p> <div class="journey-footer svelte-1yqqw0k"><div class="journey-progress svelte-1yqqw0k"><span class="progress-text svelte-1yqqw0k"> </span> <div class="progress-bar-mini svelte-1yqqw0k"><div class="progress-fill svelte-1yqqw0k"></div></div></div> <!></div></div>'),lo=C('<div class="library-loading svelte-1yqqw0k"><div class="loading-spinner svelte-1yqqw0k"></div> <p>Loading library...</p></div>'),co=C('<p class="library-empty svelte-1yqqw0k">No projects yet. Create your first project to get started!</p>'),vo=(e,t,r)=>t(i(r).id),uo=C('<span class="active-indicator svelte-1yqqw0k">Active</span>'),fo=C('<p class="library-item-description svelte-1yqqw0k"> </p>'),ho=(e,t,r)=>{e.stopPropagation(),t(i(r).id,i(r).title)},po=C('<div><div class="library-item-content svelte-1yqqw0k"><div class="library-item-header svelte-1yqqw0k"><h4 class="library-item-title svelte-1yqqw0k"> </h4> <div class="library-item-meta svelte-1yqqw0k"><span class="library-item-progress svelte-1yqqw0k"> </span> <!></div></div> <p class="library-item-author svelte-1yqqw0k"> </p> <!></div> <div class="library-item-actions svelte-1yqqw0k"><button class="delete-button svelte-1yqqw0k" aria-label="Delete project" title="Delete project"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z"></path><path fill-rule="evenodd" d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H5a1 1 0 011-1h4a1 1 0 011 1h2.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"></path></svg></button></div></div>'),_o=C('<div class="library-grid svelte-1yqqw0k"></div>'),go=C('<div class="library-section svelte-1yqqw0k"><h3 class="library-title svelte-1yqqw0k">Project Library</h3> <!> <div class="library-actions svelte-1yqqw0k"><!> <!> <!></div></div>'),bo=C('<div class="current-project-info svelte-1yqqw0k"><h4 class="current-project-title svelte-1yqqw0k"> </h4> <p class="current-project-author svelte-1yqqw0k"> </p></div>'),yo=C('<div class="current-project-info svelte-1yqqw0k"><p class="no-project-text svelte-1yqqw0k">No project selected</p></div>'),wo=C('<div class="stats-section svelte-1yqqw0k"><h3 class="stats-title svelte-1yqqw0k">Project Statistics</h3> <!> <div class="stats-grid svelte-1yqqw0k"><div class="stat-item svelte-1yqqw0k"><span class="stat-icon svelte-1yqqw0k">üìñ</span> <span class="stat-number svelte-1yqqw0k"> </span> <span class="stat-desc svelte-1yqqw0k">Chapters Written</span></div> <div class="stat-item svelte-1yqqw0k"><span class="stat-icon svelte-1yqqw0k">üåç</span> <span class="stat-number svelte-1yqqw0k"> </span> <span class="stat-desc svelte-1yqqw0k">World Created</span></div> <div class="stat-item svelte-1yqqw0k"><span class="stat-icon svelte-1yqqw0k">üë•</span> <span class="stat-number svelte-1yqqw0k"> </span> <span class="stat-desc svelte-1yqqw0k">Characters</span></div> <div class="stat-item svelte-1yqqw0k"><span class="stat-icon svelte-1yqqw0k">üìù</span> <span class="stat-number svelte-1yqqw0k"> </span> <span class="stat-desc svelte-1yqqw0k">Outline</span></div></div></div>'),mo=C('<section class="journey-section svelte-1yqqw0k"><div class="journey-grid svelte-1yqqw0k"></div></section> <div class="bottom-section svelte-1yqqw0k"><!> <!></div>',1),xo=C('<div class="dashboard svelte-1yqqw0k"><main class="dashboard-main svelte-1yqqw0k"><!></main></div> <!> <input type="file" accept=".docx,.odt,.epub" style="display: none;">',1);function Co(e,t){Ee(t,!0);let r=A(!1),a=A(null),n=A(pe({hasWorld:!1,hasCharacters:!1,hasOutline:!1,chapterCount:0})),s=A(null),o=A(pe([])),c=A(!0),u=A(!0),f=A(null),p=me(()=>[{id:"world",number:1,title:"World Building",description:"Create your story's universe",action:i(n).hasWorld?"Edit World":"Start World Building",completed:i(n).hasWorld,progress:i(n).hasWorld?100:0},{id:"characters",number:2,title:"Characters",description:"Develop your cast",action:i(n).hasCharacters?"Edit Characters":"Create Characters",completed:i(n).hasCharacters,progress:i(n).hasCharacters?100:0},{id:"outline",number:3,title:"Outline",description:"Structure your story",action:i(n).hasOutline?"Edit Outline":"Create Outline",completed:i(n).hasOutline,progress:i(n).hasOutline?100:0},{id:"chapters",number:4,title:"Chapters",description:"Write your story",action:i(n).chapterCount>0?`Continue Writing (${i(n).chapterCount} chapters)`:"Start Writing",completed:!1,progress:i(n).chapterCount>0?Math.min(i(n).chapterCount*10,100):0}]);ts(async()=>{await _()});async function _(){try{l(c,!0),l(u,!0);const[P,D,m]=await Promise.all([fetch("/api/project-status"),fetch("/api/projects/current"),fetch("/api/library")]);if(!P.ok)throw new Error(`HTTP error! status: ${P.status}`);let M=await P.json();if(D.ok){const T=await D.json();l(s,T.current_project,!0)}m.ok&&l(o,await m.json(),!0),i(s)?l(n,await d(i(s).id,M),!0):l(n,M,!0)}catch(P){console.error("Failed to fetch data:",P),l(f,"Failed to load project data")}finally{l(c,!1),l(u,!1)}}async function d(P,D){var m,M,T,x,S,ee;try{const[N,j,K,le]=await Promise.all([fetch(`/api/projects/${P}/world.json`).catch(()=>({ok:!1})),fetch(`/api/projects/${P}/characters.json`).catch(()=>({ok:!1})),fetch(`/api/projects/${P}/outline.json`).catch(()=>({ok:!1})),fetch(`/api/projects/${P}/chapters.json`).catch(()=>({ok:!1}))]);let O=!1,H=!1,Y=!1,Q=0;if(N.ok)try{const z=await N.json();O=z&&(z.world_theme||z.content)&&(((m=z.world_theme)==null?void 0:m.trim().length)>50||((M=z.content)==null?void 0:M.trim().length)>50)}catch{const U=await fetch(`/api/projects/${P}/world.txt`).catch(()=>({ok:!1}));if(U.ok){const ne=await U.text();O=ne&&ne.trim().length>50}}if(j.ok)try{const z=await j.json();H=z&&(Array.isArray(z)?z.length>0:((T=z.characters)==null?void 0:T.length)>0||((x=z.content)==null?void 0:x.trim().length)>50)}catch{const U=await fetch(`/api/projects/${P}/characters.txt`).catch(()=>({ok:!1}));if(U.ok){const ne=await U.text();H=ne&&ne.trim().length>50}}if(K.ok)try{const z=await K.json();Y=z&&(((S=z.outline)==null?void 0:S.trim().length)>50||((ee=z.content)==null?void 0:ee.trim().length)>50||Array.isArray(z.chapters)&&z.chapters.length>0)}catch{const U=await fetch(`/api/projects/${P}/outline.txt`).catch(()=>({ok:!1}));if(U.ok){const ne=await U.text();Y=ne&&ne.trim().length>50}}if(le.ok)try{const z=await le.json();Array.isArray(z)?Q=z.length:z.chapters&&Array.isArray(z.chapters)?Q=z.chapters.length:z.chapter_count&&(Q=z.chapter_count)}catch{const U=await fetch(`/api/projects/${P}/chapters/`).catch(()=>({ok:!1}));if(U.ok)try{const ne=await U.json();Array.isArray(ne)&&(Q=ne.filter(be=>be.name.endsWith(".txt")||be.name.endsWith(".md")).length)}catch{Q=D.chapterCount||0}}return{hasWorld:O,hasCharacters:H,hasOutline:Y,chapterCount:Q}}catch(N){return console.error("Error loading actual project data:",N),D}}function h(P){window.history.pushState({},"",`/${P}`),window.dispatchEvent(new PopStateEvent("popstate"))}async function b(){l(r,!0)}async function w(P){try{(await fetch(`/api/library/switch/${P.id}`,{method:"POST"})).ok&&(await _(),qe.success(`Switched to project: ${P.title}`))}catch(D){console.error("Failed to switch to new project:",D),qe.error("Failed to switch to new project")}l(r,!1)}async function q(P){try{if((await fetch(`/api/library/switch/${P}`,{method:"POST"})).ok){await _();const m=i(o).find(M=>M.id===P);m&&qe.success(`Switched to project: ${m.title}`)}else qe.error("Failed to switch project")}catch(D){console.error("Failed to switch project:",D),qe.error("Failed to switch project")}}async function R(){try{const P=await fetch("/api/library/cleanup",{method:"POST"});if(P.ok){const D=await P.json();qe.success(`Cleanup completed! Removed ${D.removed_count} orphaned entries. ${D.remaining_count} projects remaining.`),await _()}}catch(P){console.error("Failed to cleanup library:",P),qe.error("Failed to cleanup library")}}function F(){i(a)&&i(a).click()}async function $(P){const D=P.target.files[0];if(!D)return;const m=[".docx",".odt",".epub"],M="."+D.name.split(".").pop().toLowerCase();if(!m.includes(M)){qe.error(`Unsupported file type. Please use: ${m.join(", ")}`);return}qe.info("Analyzing file for import...");try{const T=new FormData;T.append("file",D);const x=await fetch("/api/import/analyze",{method:"POST",body:T});if(!x.ok){const K=await x.text();qe.error(`Analysis failed: ${K}`);return}const S=await x.json();qe.success(`Found ${S.chapter_count} chapters. Importing "${S.title}"...`);const ee=new FormData;ee.append("file",D);const N=await fetch("/api/import/novel",{method:"POST",body:ee});if(!N.ok){const K=await N.text();qe.error(`Import failed: ${K}`);return}const j=await N.json();qe.success(`Successfully imported "${j.title}" with ${j.chapter_count} chapters!`),j.project_id?await q(j.project_id):await _()}catch(T){console.error("Import failed:",T),qe.error("Import failed. Please try again.")}finally{P.target.value=""}}async function k(P,D){qe.warning(`Click delete again to confirm deletion of "${D}" - this cannot be undone!`);const m=event.target.closest("button");if(!m.dataset.confirmDelete){m.dataset.confirmDelete="true",setTimeout(()=>{delete m.dataset.confirmDelete},3e3);return}try{const M=await fetch(`/api/projects/${P}`,{method:"DELETE"});if(M.ok)qe.success(`"${D}" deleted successfully`),await _();else{const T=await M.text();qe.error(`Failed to delete project: ${T}`)}}catch(M){console.error("Delete failed:",M),qe.error("Failed to delete project")}}var E=xo(),W=He(E),B=v(W),Z=v(B);{var L=P=>{var D=so();y(P,D)},V=(P,D)=>{{var m=T=>{var x=io(),S=v(x),ee=v(S),N=g(S,2);at(N,{variant:"outline",onclick:()=>window.location.reload(),children:(j,K)=>{var le=Ce("Retry");y(j,le)},$$slots:{default:!0}}),J(()=>X(ee,i(f))),y(T,x)},M=T=>{var x=mo(),S=He(x),ee=v(S);Me(ee,21,()=>i(p),Qe,(le,O)=>{_t(le,{variant:"journey",clickable:!0,get completed(){return i(O).completed},get progress(){return i(O).progress},onclick:()=>h(i(O).id),children:(H,Y)=>{var Q=oo(),z=v(Q),U=v(z),ne=v(U),be=g(U,2),Ie=v(be),ue=g(z,2),ye=v(ue),Se=g(ue,2),Be=v(Se),Oe=v(Be),De=v(Oe),Je=g(Oe,2),fe=v(Je),xe=g(Be,2);at(xe,{variant:"outline",size:"sm",children:(oe,de)=>{var te=Ce();J(()=>X(te,i(O).action)),y(oe,te)},$$slots:{default:!0}}),J(()=>{X(ne,i(O).number),X(Ie,i(O).title),X(ye,i(O).description),X(De,`${i(O).progress??""}%`),Fe(fe,`width: ${i(O).progress??""}%`)}),y(H,Q)},$$slots:{default:!0}})});var N=g(S,2),j=v(N);_t(j,{variant:"default",padding:"lg",children:(le,O)=>{var H=go(),Y=g(v(H),2);{var Q=ue=>{var ye=lo();y(ue,ye)},z=(ue,ye)=>{{var Se=Oe=>{var De=co();y(Oe,De)},Be=Oe=>{var De=_o();Me(De,21,()=>i(o),Qe,(Je,fe)=>{var xe=po(),oe=v(xe);oe.__click=[vo,q,fe];var de=v(oe),te=v(de),we=v(te),je=g(te,2),We=v(je),kt=v(We),ut=g(We,2);{var Bt=ce=>{var Ne=uo();y(ce,Ne)};I(ut,ce=>{i(s)&&i(fe).id===i(s).id&&ce(Bt)})}var $t=g(de,2),Wt=v($t),Et=g($t,2);{var Dt=ce=>{var Ne=fo(),ft=v(Ne);J(()=>X(ft,i(fe).description)),y(ce,Ne)};I(Et,ce=>{i(fe).description&&ce(Dt)})}var Vt=g(oe,2),Pt=v(Vt);Pt.__click=[ho,k,fe],J(()=>{ke(xe,1,`library-item ${i(s)&&i(fe).id===i(s).id?"active":""}`,"svelte-1yqqw0k"),X(we,i(fe).title),X(kt,`${i(fe).chapter_count??""} chapters`),X(Wt,`by ${i(fe).author??""}`)}),y(Je,xe)}),y(Oe,De)};I(ue,Oe=>{i(o).length===0?Oe(Se):Oe(Be,!1)},ye)}};I(Y,ue=>{i(u)?ue(Q):ue(z,!1)})}var U=g(Y,2),ne=v(U);at(ne,{variant:"outline",onclick:b,children:(ue,ye)=>{var Se=Ce("New Project");y(ue,Se)},$$slots:{default:!0}});var be=g(ne,2);at(be,{variant:"secondary",onclick:F,children:(ue,ye)=>{var Se=Ce("Import Story");y(ue,Se)},$$slots:{default:!0}});var Ie=g(be,2);at(Ie,{variant:"ghost",size:"sm",onclick:R,children:(ue,ye)=>{var Se=Ce("Clean Up");y(ue,Se)},$$slots:{default:!0}}),y(le,H)},$$slots:{default:!0}});var K=g(j,2);_t(K,{variant:"default",padding:"lg",children:(le,O)=>{var H=wo(),Y=g(v(H),2);{var Q=oe=>{var de=bo(),te=v(de),we=v(te),je=g(te,2),We=v(je);J(()=>{X(we,i(s).title),X(We,`by ${i(s).author??""}`)}),y(oe,de)},z=oe=>{var de=yo();y(oe,de)};I(Y,oe=>{i(s)?oe(Q):oe(z,!1)})}var U=g(Y,2),ne=v(U),be=g(v(ne),2),Ie=v(be),ue=g(ne,2),ye=g(v(ue),2),Se=v(ye),Be=g(ue,2),Oe=g(v(Be),2),De=v(Oe),Je=g(Be,2),fe=g(v(Je),2),xe=v(fe);J(()=>{X(Ie,i(n).chapterCount),X(Se,i(n).hasWorld?"1":"0"),X(De,i(n).hasCharacters?"‚úì":"‚Äî"),X(xe,i(n).hasOutline?"‚úì":"‚Äî")}),y(le,H)},$$slots:{default:!0}}),y(T,x)};I(P,T=>{i(f)?T(m):T(M,!1)},D)}};I(Z,P=>{i(c)?P(L):P(V,!1)})}var re=g(W,2);{var ae=P=>{ao(P,{onClose:()=>l(r,!1),onProjectCreated:w})};I(re,P=>{i(r)&&P(ae)})}var ie=g(re,2);ie.__change=$,At(ie,P=>l(a,P),()=>i(a)),y(e,E),Te()}vt(["click","change"]);var ko=C('<div><div class="content svelte-1ur1bpy"><!></div></div>'),Eo=C('<div class="typing-indicator svelte-1ur1bpy"><div class="spinner svelte-1ur1bpy"></div> <span class="svelte-1ur1bpy">AI is thinking...</span></div>'),To=(e,t)=>e.key==="Enter"&&!e.shiftKey&&t(),So=C('<div class="chat-container svelte-1ur1bpy"><!> <div id="chatMessages" class="chat-messages-area p-3 mb-3 border rounded svelte-1ur1bpy"><!> <!></div> <div class="input-container d-flex svelte-1ur1bpy"><textarea class="form-control me-2 svelte-1ur1bpy"></textarea> <button class="send-button btn btn-primary svelte-1ur1bpy"> </button></div> <div class="mt-3 text-center svelte-1ur1bpy"><!></div></div>');function qo(e,t){Ee(t,!0);let r=se(t,"chatHistory",15),a=se(t,"contextData",19,()=>({})),n=se(t,"placeholderText",3,"Type your message..."),s=se(t,"isGenerating",15,!1),o=se(t,"topic",15,""),c=A(""),u;$e(()=>{u&&(u.scrollTop=u.scrollHeight)});async function f(){const L=i(c).trim();if(!L||s())return;l(c,""),s(!0),r([...r(),{role:"user",content:L}]),!o()&&r().filter(ie=>ie.role==="user").length===1&&(o(L.split(" ").slice(0,5).join(" ")),console.log("Derived topic:",o()));let V=r().length;r([...r(),{role:"assistant",content:'<span class="typing-cursor">‚ñå</span>'}]),r([...r()]);const re={message:L,chat_history:r().slice(0,V),...a(),topic:o()};let ae="";try{const ie=await fetch(t.chatEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)});if(!ie.ok||!ie.body){const m=await ie.json().catch(()=>({detail:"Unknown error"}));throw new Error(`Chat stream request failed: ${ie.status} ${ie.statusText} - ${m.detail}`)}const P=ie.body.getReader(),D=new TextDecoder;for(r()[V]?(r(r()[V].content="",!0),r([...r()])):(r([...r(),{role:"assistant",content:""}]),V=r().length-1,r([...r()]));;){const{done:m,value:M}=await P.read();if(m)break;D.decode(M).split(`

`).filter(Boolean).forEach(x=>{if(x.startsWith("data: "))try{const S=x.substring(6);if(S==="[DONE]")return;const ee=JSON.parse(S);ee.content!==void 0&&(ae+=ee.content,r()[V]&&(r(r()[V].content=p(ae)+'<span class="typing-cursor">‚ñå</span>',!0),r([...r()])))}catch(S){console.error("Error parsing SSE data line:",S,jsonData),r()[V]&&(r(r()[V].content=p(ae)+` [Parsing Error: ${S.message}]<span class="typing-cursor">‚ñå</span>`,!0),r([...r()]))}})}r()[V]&&(r(r()[V].content=p(ae),!0),r([...r()]))}catch(ie){console.error("Chat stream fetch error:",ie),r()[V]?(r(r()[V].content=p(ae)+` [Error: ${ie.message}]`,!0),r([...r()])):(r([...r(),{role:"system",content:`Error communicating with AI: ${ie.message}. Please check the console.`}]),r([...r()]))}finally{s(!1)}}function p(L){return L.replace(/\n{2,}/g,"<br><br>").replace(/\n/g,"<br>")}var _=So(),d=v(_);{var h=L=>{var V=ar(),re=He(V);gr(re,()=>t.introText),y(L,V)};I(d,L=>{t.introText&&L(h)})}var b=g(d,2),w=v(b);Me(w,17,r,Qe,(L,V)=>{var re=ko(),ae=v(re),ie=v(ae);nr(ie,()=>p(i(V).content)),J(()=>ke(re,1,`message ${i(V).role??""}`,"svelte-1ur1bpy")),y(L,re)});var q=g(w,2);{var R=L=>{var V=Eo();y(L,V)};I(q,L=>{s()&&L(R)})}At(b,L=>u=L,()=>u);var F=g(b,2),$=v(F);$.__keydown=[To,f];var k=g($,2);k.__click=f;var E=v(k),W=g(F,2),B=v(W);{var Z=L=>{var V=ar(),re=He(V);gr(re,()=>t.belowInput),y(L,V)};I(B,L=>{t.belowInput&&L(Z)})}J(L=>{Ze($,"placeholder",n()),$.disabled=s(),k.disabled=L,X(E,s()?"...":"Send")},[()=>s()||!i(c).trim()]),Ke($,()=>i(c),L=>l(c,L)),y(e,_),Te()}vt(["keydown","click"]);var Oo=C('<p class="topic-display svelte-1ljww8c">Current Topic: <strong class="svelte-1ljww8c"> </strong></p>'),jo=C('<div class="error-message svelte-1ljww8c"> </div>'),Ao=C(`<div class="world-header svelte-1ljww8c"><h1 class="svelte-1ljww8c">Create World Setting</h1> <!></div> <div class="world-intro svelte-1ljww8c"><p class="lead-text svelte-1ljww8c">Start by chatting with the AI to develop your book's world. Describe your ideas, answer
					questions, and explore different aspects of your world together.</p> <!> <!></div>`,1),$o=C('<div class="loading-state svelte-1ljww8c"><div class="loading-spinner svelte-1ljww8c"></div> <p>Loading world data...</p></div>'),Do=C('<div class="error-message svelte-1ljww8c"> </div>'),Po=C('<div class="generating-indicator svelte-1ljww8c"><div class="loading-spinner svelte-1ljww8c"></div> <span>AI is thinking...</span></div>'),Ro=C('<div class="chat-actions svelte-1ljww8c"><!> <!></div>'),Mo=C('<div class="chat-section svelte-1ljww8c"><h2 class="section-title svelte-1ljww8c">World Building Chat</h2> <!></div>'),Fo=C('<div class="status-message saving svelte-1ljww8c"><div class="loading-spinner svelte-1ljww8c"></div> <span>Saving changes...</span></div>'),Io=C('<div class="status-message success svelte-1ljww8c">World setting saved successfully!</div>'),No=C('<div class="editing-section svelte-1ljww8c"><h2 class="section-title svelte-1ljww8c">Your World Setting</h2> <form class="world-form svelte-1ljww8c"><div class="field-group svelte-1ljww8c"><label for="worldTheme" class="field-label svelte-1ljww8c">Edit your world setting if needed:</label> <textarea class="field-textarea svelte-1ljww8c" id="worldTheme" name="world_theme" rows="12"></textarea></div> <div class="form-actions svelte-1ljww8c"><!> <!></div></form> <!> <!></div>'),zo=C('<div class="world-container svelte-1ljww8c"><div class="world-content svelte-1ljww8c"><!> <!> <!> <!> <!></div></div>');function Lo(e,t){Ee(t,!0);let r=se(t,"initial_world_theme",3,""),a=se(t,"initial_topic",3,""),n=A(pe([])),s=A(""),o=A(pe(a()||"")),c=A(!0),u=A(null),f=A(!1),p=A(!1),_=A(null),d=A(!0),h=A(!1),b=me(()=>i(n).filter(m=>m.role==="user").length===0||i(c)||i(h)),w=me(()=>!i(c)&&i(s).length>0),q;const R="Tell me about the world you want to create for your book. What kind of setting, time period, or genre are you interested in?";$e(()=>{async function m(){l(c,!0),l(u,null),l(d,!0);try{const M=await fetch("/api/world");if(!M.ok){const x=await M.text();throw new Error(`HTTP error! status: ${M.status}: ${x}`)}const T=await M.json();l(s,T.world_theme||r(),!0),l(o,T.topic||a(),!0),i(s)?l(n,[{role:"system",content:"Loaded existing World Setting:"},{role:"assistant",content:i(s)}],!0):l(n,[{role:"assistant",content:R}],!0)}catch(M){console.error("Error loading initial world data:",M),l(u,`Failed to load initial data: ${M.message}`),l(s,r()),l(o,a()),l(n,[{role:"system",content:`Error loading previous world data: ${M.message}`},{role:"assistant",content:R}],!0)}finally{l(c,!1),l(d,!i(w))}}m()}),$e(()=>{!i(f)&&!i(c)&&i(w)?l(d,!1):i(w)||l(d,!0)});async function F(){if(i(n).filter(S=>S.role==="user").length===0){alert("Please send at least one message to the AI before finalizing.");return}if(i(b))return;l(s,""),l(_,null);const m={chat_history:i(n),topic:i(o)};let M="",T=new AbortController,x=T.signal;l(h,!0);try{const S=await fetch("/finalize_world_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m),signal:x});if(!S.ok||!S.body){const j=await S.text();throw new Error(`HTTP error! status: ${S.status}: ${j}`)}const ee=S.body.getReader(),N=new TextDecoder;for(;;){const{value:j,done:K}=await ee.read();if(K||(N.decode(j).split(`

`).filter(Boolean).forEach(O=>{if(O.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",O),l(_,`AI streaming error: ${O.substring(O.indexOf("[STREAMING ERROR: "))}`),l(h,!1),T.abort();return}if(O.startsWith("data: "))try{const H=O.substring(6);if(H==="[DONE]")return;const Y=JSON.parse(H);Y.content!==void 0&&(M+=Y.content,l(s,M,!0))}catch(H){console.error("Error parsing JSON from finalize stream:",H,jsonData),l(s,i(s)+` [Parsing Error: ${H.message}]`),l(_,"Failed to parse AI response chunk.")}}),x.aborted))break}}catch(S){S.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch or stream reading error for final world setting:",S),l(_,`Error finalizing world setting: ${S.message}`),i(s).includes("Error finalizing world setting:")||l(s,`Error finalizing world setting: ${S.message}

`+i(s)))}finally{i(_)||l(h,!1)}}async function $(m){if(m.preventDefault(),i(d))return;l(f,!0),l(p,!1),l(_,null),l(d,!0);const M={world_theme:i(s)};try{const T=await fetch("/save_world",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!T.ok){const x=await T.text();throw new Error(`HTTP error! status: ${T.status}: ${x}`)}l(f,!1),l(p,!0),setTimeout(()=>{l(p,!1)},3e3)}catch(T){console.error("Error saving world theme:",T),l(_,`Error saving world theme: ${T.message}`),l(f,!1),l(d,!1)}}function k(m){history.pushState(null,"",m),window.dispatchEvent(new PopStateEvent("popstate"))}var E=zo(),W=v(E),B=v(W);_t(B,{padding:"lg",children:(m,M)=>{var T=Ao(),x=He(T),S=g(v(x),2);const ee=me(()=>!i(s)||i(f)||i(c)||i(h));at(S,{variant:"primary",size:"sm",onclick:()=>k("/characters"),get disabled(){return i(ee)},children:(H,Y)=>{var Q=Ce("Next: Characters ‚Üí");y(H,Q)},$$slots:{default:!0}});var N=g(x,2),j=g(v(N),2);{var K=H=>{var Y=Oo(),Q=g(v(Y)),z=v(Q);J(()=>X(z,i(o))),y(H,Y)};I(j,H=>{i(o)&&H(K)})}var le=g(j,2);{var O=H=>{var Y=jo(),Q=v(Y);J(()=>X(Q,i(u))),y(H,Y)};I(le,H=>{i(u)&&H(O)})}y(m,T)},$$slots:{default:!0}});var Z=g(B,2);{var L=m=>{_t(m,{padding:"lg",children:(M,T)=>{var x=$o();y(M,x)},$$slots:{default:!0}})};I(Z,m=>{i(c)&&m(L)})}var V=g(Z,2);{var re=m=>{_t(m,{padding:"lg",children:(M,T)=>{var x=Do(),S=v(x);J(()=>X(S,i(_))),y(M,x)},$$slots:{default:!0}})};I(V,m=>{i(_)&&m(re)})}var ae=g(V,2);{var ie=m=>{_t(m,{padding:"lg",children:(M,T)=>{var x=Mo(),S=g(v(x),2);qo(S,{chatEndpoint:"/world_chat_stream",contextData:{},placeholderText:"Type your ideas about the world you want to create...",get chatHistory(){return i(n)},set chatHistory(j){l(n,j,!0)},get isGenerating(){return i(h)},set isGenerating(j){l(h,j,!0)},get topic(){return i(o)},set topic(j){l(o,j,!0)},introText:j=>{},belowInput:j=>{var K=Ro(),le=v(K);at(le,{variant:"success",onclick:F,get disabled(){return i(b)},children:(Y,Q)=>{var z=Ce("Finalize World Setting");y(Y,z)},$$slots:{default:!0}});var O=g(le,2);{var H=Y=>{var Q=Po();y(Y,Q)};I(O,Y=>{i(h)&&Y(H)})}y(j,K)},$$slots:{introText:!0,belowInput:!0}}),y(M,x)},$$slots:{default:!0}})};I(ae,m=>{!i(w)&&!i(c)&&m(ie)})}var P=g(ae,2);{var D=m=>{_t(m,{padding:"lg",children:(M,T)=>{var x=No(),S=g(v(x),2),ee=v(S),N=g(v(ee),2);At(N,U=>q=U,()=>q);var j=g(ee,2),K=v(j);at(K,{type:"submit",variant:"success",get disabled(){return i(d)},children:(U,ne)=>{var be=Ce("Save Changes");y(U,be)},$$slots:{default:!0}});var le=g(K,2);const O=me(()=>!i(s)||i(f)||i(c)||i(h));at(le,{variant:"primary",onclick:()=>k("/characters"),get disabled(){return i(O)},children:(U,ne)=>{var be=Ce("Continue to Characters");y(U,be)},$$slots:{default:!0}});var H=g(S,2);{var Y=U=>{var ne=Fo();y(U,ne)};I(H,U=>{i(f)&&U(Y)})}var Q=g(H,2);{var z=U=>{var ne=Io();y(U,ne)};I(Q,U=>{i(p)&&U(z)})}dt("submit",S,$),Ke(N,()=>i(s),U=>l(s,U)),y(M,x)},$$slots:{default:!0}})};I(P,m=>{i(w)&&m(D)})}y(e,E),Te()}async function Ho(e,t,r,a,n,s,o,c,u,f){if(i(t).filter(h=>h.role==="user").length===0){alert("Please send at least one message to the AI before finalizing.");return}if(i(r))return;l(a,!0),l(n,""),l(s,""),l(o,null);const p={chat_history:i(t),world_theme:i(c),num_characters:i(u)};let _=new AbortController,d=_.signal;try{const h=await fetch("/finalize_characters_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p),signal:d});if(!h.ok||!h.body){const R=await h.text();throw new Error(`HTTP error! status: ${h.status}: ${R}`)}const b=h.body.getReader(),w=new TextDecoder;let q="";for(;;){const{value:R,done:F}=await b.read();if(F||(w.decode(R).split(`

`).filter(Boolean).forEach(k=>{if(k.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",k),l(o,`AI streaming error: ${k.substring(k.indexOf("[STREAMING ERROR: "))}`),l(a,!1),_.abort();return}if(k.startsWith("data: "))try{const E=k.substring(6);if(E==="[DONE]")return;const W=JSON.parse(E);W.content!==void 0&&(q+=W.content,l(s,q,!0))}catch(E){console.error("Error parsing JSON from finalize stream:",E,jsonData),l(s,i(s)+` [Parsing Error: ${E.message}]`),l(o,"Failed to parse AI response chunk during finalization.")}}),d.aborted))break}l(f,!0)}catch(h){h.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch error for final characters:",h),l(o,`Error finalizing characters: ${h.message}`),l(s,`Error finalizing characters: ${h.message}

`+i(s)),l(f,!0))}finally{i(o)||l(a,!1)}}async function Bo(e,t){const r={characters:i(t)};try{const a=await fetch("/save_characters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok){const n=await a.text();throw new Error(`HTTP error! status: ${a.status}: ${n}`)}alert("Characters saved successfully!")}catch(a){console.error("Error saving characters:",a),alert(`Failed to save characters: ${a.message}`)}}var Wo=C('<a href="/outline" class="btn btn-light svelte-1ibv7hy">Next: Outline &raquo;</a>'),Vo=C('<div class="col-12 mb-4 svelte-1ibv7hy"><div class="alert alert-warning svelte-1ibv7hy"><strong class="svelte-1ibv7hy">Context needed!</strong> Please ensure you have set your <a href="/world" class="alert-link svelte-1ibv7hy">World Setting</a> before developing characters.</div></div>'),Go=C('<div class="col-12 mb-4 svelte-1ibv7hy"><div class="alert alert-danger mt-3 svelte-1ibv7hy" role="alert"> </div></div>'),Jo=(e,t)=>l(t,!i(t)),Uo=C('<div class="full-world mt-2 pt-2 border-top svelte-1ibv7hy"><p class="svelte-1ibv7hy"> </p></div>'),Zo=C('<div><div class="content svelte-1ibv7hy"><!></div></div>'),Yo=C('<div class="message assistant svelte-1ibv7hy"><div class="content svelte-1ibv7hy"><!><span class="typing-cursor svelte-1ibv7hy">|</span></div></div>'),Ko=C('<div class="typing-indicator svelte-1ibv7hy"><div class="spinner svelte-1ibv7hy"></div> <span class="svelte-1ibv7hy">AI is thinking...</span></div>'),Xo=C(`<div class="mb-3 svelte-1ibv7hy"><label for="numCharacters" class="form-label svelte-1ibv7hy">Approximate number of main characters to generate:</label> <input type="number" id="numCharacters" class="form-control svelte-1ibv7hy" min="1" max="20" step="1"></div> <div class="card chat-card svelte-1ibv7hy"><div class="card-header bg-primary text-white svelte-1ibv7hy"><h3 class="h5 mb-0 svelte-1ibv7hy">Character Building Chat</h3></div> <div class="chat-container card-body svelte-1ibv7hy"><p class="lead svelte-1ibv7hy">Chat here to brainstorm ideas for your characters. When you're ready, click
								"Finalize Characters" to generate structured character descriptions based on the
								conversation.</p> <div class="chat-messages-area svelte-1ibv7hy"><!> <!> <!></div> <div class="input-container d-flex svelte-1ibv7hy"><textarea class="form-control svelte-1ibv7hy" placeholder="Describe a character or type your ideas..." rows="1"></textarea> <button class="btn btn-primary ms-2 svelte-1ibv7hy">Send</button></div> <div class="mt-3 text-center svelte-1ibv7hy"><button class="btn btn-success svelte-1ibv7hy">Finalize Characters</button></div></div></div>`,1),Qo=C('<div class="card results-card svelte-1ibv7hy"><div class="card-header bg-success text-white svelte-1ibv7hy"><h3 class="h5 mb-0 svelte-1ibv7hy">Your Characters</h3></div> <div class="card-body svelte-1ibv7hy"><p class="lead svelte-1ibv7hy">Here are the generated character descriptions. You can edit them directly.</p> <div class="form-group mb-3 svelte-1ibv7hy"><label for="charactersContent" class="form-label svelte-1ibv7hy">Edit your characters:</label> <textarea id="charactersContent" rows="15" class="form-control svelte-1ibv7hy"></textarea></div> <div class="d-flex justify-content-between svelte-1ibv7hy"><button class="save-button btn btn-success svelte-1ibv7hy">Save Characters</button> <a href="/outline" class="btn btn-primary svelte-1ibv7hy">Continue to Outline</a></div></div></div>'),el=C('<div class="col-12 svelte-1ibv7hy"><div class="world-context mb-4 svelte-1ibv7hy"><h3 class="svelte-1ibv7hy">World Setting Context:</h3> <div class="context-card card bg-light svelte-1ibv7hy"><div class="card-body svelte-1ibv7hy"><p class="card-text small mb-0 svelte-1ibv7hy"> </p> <button class="btn btn-link btn-sm p-0 svelte-1ibv7hy"> </button> <!></div></div></div> <!></div>'),tl=C(`<div class="characters-container svelte-1ibv7hy"><div class="row svelte-1ibv7hy"><div class="col-12 mb-4 svelte-1ibv7hy"><div class="card svelte-1ibv7hy"><div class="card-header bg-primary text-white d-flex justify-content-between align-items-center svelte-1ibv7hy"><h1 class="h4 mb-0 svelte-1ibv7hy">Develop Characters</h1> <div class="navigation-buttons svelte-1ibv7hy"><a href="/world" class="btn btn-light svelte-1ibv7hy">&laquo; Previous: World</a> <!></div></div> <div class="card-body svelte-1ibv7hy"><p class="lead svelte-1ibv7hy">Chat with the AI to brainstorm and develop your book's characters. Define their roles,
						personalities, and backstories.</p></div></div></div> <!> <!> <!></div></div>`);function rl(e,t){Ee(t,!0);let r=A(""),a=A(""),n=A(pe([])),s=A(!1),o=A(5),c=A(!1),u=A(""),f=A(!1),p=A(""),_=A(null),d=null;$e(()=>{d&&(d.scrollTop=d.scrollHeight)});async function h(){if(!i(u).trim()||i(f))return;const D={role:"user",content:i(u)};l(n,[...i(n),D],!0),l(u,""),l(f,!0),l(p,""),l(_,null);const m={chat_history:i(n),world_theme:i(a),num_characters:i(o)};let M=new AbortController,T=M.signal;try{const x=await fetch("/characters_chat_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m),signal:T});if(!x.ok||!x.body){const j=await x.text();throw new Error(`HTTP error! status: ${x.status}: ${j}`)}const S=x.body.getReader(),ee=new TextDecoder;let N="";for(;;){const{value:j,done:K}=await S.read();if(K||(ee.decode(j).split(`

`).filter(Boolean).forEach(O=>{if(O.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",O),l(_,`AI streaming error: ${O.substring(O.indexOf("[STREAMING ERROR: "))}`),l(f,!1),M.abort();return}if(O.startsWith("data: "))try{const H=O.substring(6);if(H==="[DONE]")return;const Y=JSON.parse(H);Y.content!==void 0&&(N+=Y.content,l(p,N,!0))}catch(H){console.error("Error parsing JSON from stream:",H,jsonData),l(_,"Failed to parse AI response chunk.")}}),T.aborted))break}i(_)||l(n,[...i(n),{role:"assistant",content:N}],!0)}catch(x){x.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch or stream reading error for chat stream:",x),l(_,`Fetch or stream error: ${x.message}`),l(n,[...i(n),{role:"system",content:`Error: ${x.message}`}],!0))}finally{i(_)||(l(f,!1),l(p,""))}}function b(D){return D.split(`

`).map(m=>m.startsWith("```")?`<pre><code>${m.substring(3).replace("```","")}</code></pre>`:`<p>${m}</p>`).join("")}let w=me(()=>i(n).filter(D=>D.role==="user").length===0||i(f));const q="Based on your world setting, what kind of characters are you thinking of? You can describe individuals, archetypes, or groups. I can help you brainstorm or generate character concepts.";$e(()=>{async function D(){try{const m=await fetch("/api/world");if(!m.ok)throw new Error("Failed to fetch world data");const M=await m.json();l(a,M.world_theme||"No world theme set.",!0);const T=await fetch("/api/characters");if(!T.ok)l(n,[{role:"assistant",content:q}],!0),l(c,!1);else{const x=await T.json();l(r,x.characters||"",!0),i(r)?l(c,!0):(l(n,[{role:"assistant",content:q}],!0),l(c,!1))}}catch(m){console.error("Error loading context data:",m),l(n,[{role:"system",content:`Error loading context data: ${m.message}`},{role:"assistant",content:q}],!0),l(c,!1)}}D()});var R=tl(),F=v(R),$=v(F),k=v($),E=v(k),W=g(v(E),2),B=g(v(W),2);{var Z=D=>{var m=Wo();y(D,m)};I(B,D=>{i(r)&&D(Z)})}var L=g($,2);{var V=D=>{var m=Vo();y(D,m)};I(L,D=>{i(a)||D(V)})}var re=g(L,2);{var ae=D=>{var m=Go(),M=v(m),T=v(M);J(()=>X(T,i(_))),y(D,m)};I(re,D=>{i(_)&&D(ae)})}var ie=g(re,2);{var P=D=>{var m=el(),M=v(m),T=g(v(M),2),x=v(T),S=v(x),ee=v(S),N=g(S,2);N.__click=[Jo,s];var j=v(N),K=g(N,2);{var le=Q=>{var z=Uo(),U=v(z),ne=v(U);J(()=>X(ne,i(a))),y(Q,z)};I(K,Q=>{i(s)&&Q(le)})}var O=g(M,2);{var H=Q=>{var z=Xo(),U=He(z),ne=g(v(U),2),be=g(U,2),Ie=g(v(be),2),ue=g(v(Ie),2),ye=v(ue);Me(ye,17,()=>i(n),te=>te.role+te.content,(te,we)=>{var je=Zo(),We=v(je),kt=v(We);nr(kt,()=>b(i(we).content)),J(()=>ke(je,1,`message ${i(we).role??""}`,"svelte-1ibv7hy")),y(te,je)});var Se=g(ye,2);{var Be=te=>{var we=Yo(),je=v(we),We=v(je);nr(We,()=>b(i(p))),y(te,we)};I(Se,te=>{i(p)&&te(Be)})}var Oe=g(Se,2);{var De=te=>{var we=Ko();y(te,we)};I(Oe,te=>{i(f)&&!i(p)&&te(De)})}At(ue,te=>d=te,()=>d);var Je=g(ue,2),fe=v(Je),xe=g(fe,2);xe.__click=h;var oe=g(Je,2),de=v(oe);de.__click=[Ho,n,w,f,p,r,_,a,o,c],J(()=>{fe.disabled=i(f),xe.disabled=i(f),de.disabled=i(w)}),Ke(ne,()=>i(o),te=>l(o,te)),dt("keypress",fe,te=>{te.key==="Enter"&&!te.shiftKey&&(te.preventDefault(),h())}),Ke(fe,()=>i(u),te=>l(u,te)),y(Q,z)},Y=Q=>{var z=Qo(),U=g(v(z),2),ne=g(v(U),2),be=g(v(ne),2),Ie=g(ne,2),ue=v(Ie);ue.__click=[Bo,r],Ke(be,()=>i(r),ye=>l(r,ye)),y(Q,z)};I(O,Q=>{i(c)?Q(Y,!1):Q(H)})}J(Q=>{X(ee,Q),X(j,i(s)?"Show less":"Show more")},[()=>i(s)?i(a):i(a).substring(0,200)+"..."]),y(D,m)};I(ie,D=>{i(a)&&D(P)})}y(e,R),Te()}vt(["click"]);async function al(e,t,r,a,n,s,o,c,u,f,p,_){if(i(t).filter(w=>w.role==="user").length===0){alert("Please send at least one message to the AI before finalizing.");return}if(i(r))return;l(a,!0),l(n,""),l(s,""),l(o,null);const d={chat_history:i(t),world_theme:i(c),characters:i(u),num_chapters:i(f)};let h=new AbortController,b=h.signal;try{const w=await fetch("/finalize_outline_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),signal:b});if(!w.ok||!w.body){const $=await w.text();throw new Error(`HTTP error! status: ${w.status}: ${$}`)}const q=w.body.getReader(),R=new TextDecoder;let F="";for(;;){const{value:$,done:k}=await q.read();if(k||(R.decode($).split(`

`).filter(Boolean).forEach(W=>{if(W.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",W),l(o,`AI streaming error: ${W.substring(W.indexOf("[STREAMING ERROR: "))}`),l(s,`Error finalizing outline: ${i(o)}

`+i(s)),l(a,!1),h.abort();return}if(W.startsWith("data: "))try{const B=W.substring(6);if(B==="[DONE]")return;const Z=JSON.parse(B);Z.content!==void 0&&(F+=Z.content,l(s,F,!0))}catch(B){console.error("Error parsing JSON from finalize stream:",B,jsonData),l(s,i(s)+` [Parsing Error: ${B.message}]`),l(o,"Failed to parse AI response chunk during finalization.")}}),b.aborted))break}l(_,!0)}catch(w){w.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch error for final outline:",w),l(o,`Error finalizing outline: ${w.message}`),l(s,`Error finalizing outline: ${w.message}

`+i(s)),l(_,!0))}finally{i(o)||(l(a,!1),l(n,""))}}async function nl(e,t){const r={outline:i(t)};try{const a=await fetch("/save_outline",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok){const n=await a.text();throw new Error(`HTTP error! status: ${a.status}: ${n}`)}alert("Outline saved successfully!")}catch(a){console.error("Error saving outline:",a),alert(`Failed to save outline: ${a.message}`)}}var sl=C('<a href="/chapters" class="btn btn-light svelte-ne31rl">Next: Chapters &raquo;</a>'),il=C('<div class="col-12 mb-4 svelte-ne31rl"><div class="alert alert-warning svelte-ne31rl"><strong class="svelte-ne31rl">Context needed!</strong> Please ensure you have set your <a href="/world" class="alert-link svelte-ne31rl">World Setting</a> and <a href="/characters" class="alert-link svelte-ne31rl">Characters</a> before generating an outline.</div></div>'),ol=C('<div class="col-12 mb-4 svelte-ne31rl"><div class="alert alert-danger mt-3 svelte-ne31rl" role="alert"> </div></div>'),ll=(e,t)=>l(t,!i(t)),cl=(e,t)=>l(t,!i(t)),dl=C('<div><div class="content svelte-ne31rl"><!></div></div>'),vl=C('<div class="message assistant svelte-ne31rl"><div class="content svelte-ne31rl"><!><span class="typing-cursor svelte-ne31rl">|</span></div></div>'),ul=C('<div class="typing-indicator svelte-ne31rl"><div class="spinner svelte-ne31rl"></div> <span class="svelte-ne31rl">AI is thinking...</span></div>'),fl=C(`<div class="mb-3 svelte-ne31rl"><label for="numChapters" class="form-label svelte-ne31rl">Approximate number of chapters for the final outline:</label> <input type="number" id="numChapters" class="form-control svelte-ne31rl" min="1" max="100" step="1"></div> <div class="card chat-card svelte-ne31rl"><div class="card-header bg-primary text-white svelte-ne31rl"><h3 class="h5 mb-0 svelte-ne31rl">Outline Building Chat</h3></div> <div class="chat-container card-body svelte-ne31rl"><p class="lead svelte-ne31rl">Chat here to brainstorm ideas for your outline. When you're ready, click "Finalize
								Outline" to generate a structured outline based on the conversation.</p> <div class="chat-messages-area svelte-ne31rl"><!> <!> <!></div> <div class="input-container d-flex svelte-ne31rl"><textarea class="form-control svelte-ne31rl" placeholder="Type your ideas about the outline..." rows="1"></textarea> <button class="btn btn-primary ms-2 svelte-ne31rl">Send</button></div> <div class="mt-3 text-center svelte-ne31rl"><button class="btn btn-success svelte-ne31rl">Finalize Outline</button></div></div></div>`,1),hl=C('<li class="list-group-item svelte-ne31rl"><strong class="svelte-ne31rl"> </strong> <p class="text-muted small mb-0 svelte-ne31rl"> </p></li>'),pl=C('<div class="mt-3 svelte-ne31rl"><h4 class="svelte-ne31rl">Generated Chapters:</h4> <button class="btn btn-sm btn-secondary mb-2 svelte-ne31rl">Regenerate Chapters from Outline</button> <ul class="list-group list-group-flush svelte-ne31rl"></ul></div>'),_l=C('<div class="card results-card svelte-ne31rl"><div class="card-header bg-success text-white svelte-ne31rl"><h3 class="h5 mb-0 svelte-ne31rl">Your Outline</h3></div> <div class="card-body svelte-ne31rl"><p class="lead svelte-ne31rl">Here is the generated outline. You can edit it directly.</p> <div class="form-group mb-3 svelte-ne31rl"><label for="outlineContent" class="form-label svelte-ne31rl">Edit your outline:</label> <textarea id="outlineContent" rows="15" class="form-control svelte-ne31rl"></textarea></div> <div class="d-flex justify-content-between align-items-center svelte-ne31rl"><button class="save-button btn btn-success svelte-ne31rl">Save Outline</button> <a href="/chapters" class="btn btn-primary svelte-ne31rl">Continue to Chapters</a></div> <!></div></div>'),gl=C('<div class="col-12 svelte-ne31rl"><div class="context-accordion mb-4 svelte-ne31rl"><div class="accordion svelte-ne31rl" id="contextAccordion"><div class="accordion-item svelte-ne31rl"><h2 class="accordion-header svelte-ne31rl" id="worldContextHeading"><button class="accordion-button collapsed svelte-ne31rl" type="button" data-bs-toggle="collapse" data-bs-target="#worldContextCollapse" aria-controls="worldContextCollapse">World Setting</button></h2> <div id="worldContextCollapse" aria-labelledby="worldContextHeading" data-bs-parent="#contextAccordion"><div class="accordion-body small svelte-ne31rl"><p class="svelte-ne31rl"> </p></div></div></div> <div class="accordion-item svelte-ne31rl"><h2 class="accordion-header svelte-ne31rl" id="charactersContextHeading"><button class="accordion-button collapsed svelte-ne31rl" type="button" data-bs-toggle="collapse" data-bs-target="#charactersContextCollapse" aria-controls="charactersContextCollapse">Characters</button></h2> <div id="charactersContextCollapse" aria-labelledby="charactersContextHeading" data-bs-parent="#contextAccordion"><div class="accordion-body small svelte-ne31rl"><p class="svelte-ne31rl"> </p></div></div></div></div></div> <!></div>'),bl=C(`<div class="outline-container svelte-ne31rl"><div class="row svelte-ne31rl"><div class="col-12 mb-4 svelte-ne31rl"><div class="card svelte-ne31rl"><div class="card-header bg-primary text-white d-flex justify-content-between align-items-center svelte-ne31rl"><h1 class="h4 mb-0 svelte-ne31rl">Develop Outline</h1> <div class="navigation-buttons svelte-ne31rl"><a href="/characters" class="btn btn-light svelte-ne31rl">&laquo; Previous: Characters</a> <!></div></div> <div class="card-body svelte-ne31rl"><p class="lead svelte-ne31rl">Chat with the AI to brainstorm and refine your book's outline. You can generate a full
						outline and then break it down into individual chapters.</p></div></div></div> <!> <!> <!></div></div>`);function yl(e,t){Ee(t,!0);let r=A(""),a=A(pe([])),n=A(""),s=A(""),o=A(10),c=A(!1),u=A(!1),f=A(!1),p=A(pe([])),_=A(""),d=A(!1),h=A(""),b=A(null),w=null;$e(()=>{w&&(w.scrollTop=w.scrollHeight)});async function q(){if(!i(_).trim()||i(d))return;const x={role:"user",content:i(_)};l(p,[...i(p),x],!0),l(_,""),l(d,!0),l(h,""),l(b,null);const S={chat_history:i(p),world_theme:i(n),characters:i(s),num_chapters:i(o)};let ee=new AbortController,N=ee.signal;try{const j=await fetch("/outline_chat_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S),signal:N});if(!j.ok||!j.body){const H=await j.text();throw new Error(`HTTP error! status: ${j.status}: ${H}`)}const K=j.body.getReader(),le=new TextDecoder;let O="";for(;;){const{value:H,done:Y}=await K.read();if(Y||(le.decode(H).split(`

`).filter(Boolean).forEach(z=>{if(z.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",z),l(b,`AI streaming error: ${z.substring(z.indexOf("[STREAMING ERROR: "))}`),l(d,!1),ee.abort();return}if(z.startsWith("data: "))try{const U=z.substring(6);if(U==="[DONE]")return;const ne=JSON.parse(U);ne.content!==void 0&&(O+=ne.content,l(h,O,!0))}catch(U){console.error("Error parsing JSON from stream:",U,jsonData),l(b,"Failed to parse AI response chunk.")}}),N.aborted))break}i(b)||l(p,[...i(p),{role:"assistant",content:O}],!0)}catch(j){j.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch error for chat stream:",j),l(b,`Fetch or stream error: ${j.message}`),l(p,[...i(p),{role:"system",content:`Error: ${j.message}`}],!0))}finally{i(b)||(l(d,!1),l(h,""))}}function R(x){return x.split(`

`).map(S=>S.startsWith("```")?`<pre><code>${S.substring(3).replace("```","")}</code></pre>`:`<p>${S}</p>`).join("")}let F=me(()=>i(p).filter(x=>x.role==="user").length===0||i(d));const $="Based on the world setting and characters, what kind of plot outline or story beats are you thinking of?";$e(()=>{async function x(){try{const S=await fetch("/api/world");if(!S.ok)throw new Error("Failed to fetch world data");const ee=await S.json();l(n,ee.world_theme||"No world theme set.",!0);const N=await fetch("/api/characters");if(!N.ok)throw new Error("Failed to fetch characters data");const j=await N.json();l(s,j.characters||"No characters set.",!0);const K=await fetch("/api/outline");if(!K.ok)l(p,[{role:"assistant",content:$}],!0),l(f,!1);else{const le=await K.json();l(r,le.outline||"",!0),i(r)?l(f,!0):(l(p,[{role:"assistant",content:$}],!0),l(f,!1))}}catch(S){console.error("Error loading context data:",S),l(p,[{role:"system",content:`Error loading context data: ${S.message}`},{role:"assistant",content:$}],!0),l(f,!1)}}x()});async function k(){if(!i(r)){alert("Please finalize the outline first.");return}l(d,!0),l(a,[],!0);let x="";l(b,null);const S={outline:i(r)};let ee=new AbortController,N=ee.signal;try{const j=await fetch("/regenerate_chapters_stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S),signal:N});if(!j.ok||!j.body){const O=await j.text();throw new Error(`HTTP error! status: ${j.status}: ${O}`)}const K=j.body.getReader(),le=new TextDecoder;for(;;){const{value:O,done:H}=await K.read();if(H)break;const Y=le.decode(O);if(x+=Y,Y.includes("[STREAMING ERROR: ")){console.error("Received streaming error:",Y),l(b,`AI streaming error: ${Y.substring(Y.indexOf("[STREAMING ERROR: "))}`),l(d,!1),ee.abort();return}}i(b)}catch(j){j.name==="AbortError"?console.log("Fetch aborted due to streaming error."):(console.error("Fetch error for regenerating chapters:",j),alert(`Failed to regenerate chapters: ${j.message}`),l(a,[],!0),l(b,`Failed to regenerate chapters: ${j.message}`))}finally{i(b)||l(d,!1)}}var E=bl(),W=v(E),B=v(W),Z=v(B),L=v(Z),V=g(v(L),2),re=g(v(V),2);{var ae=x=>{var S=sl();y(x,S)};I(re,x=>{i(a).length>0&&x(ae)})}var ie=g(B,2);{var P=x=>{var S=il();y(x,S)};I(ie,x=>{(!i(n)||!i(s))&&x(P)})}var D=g(ie,2);{var m=x=>{var S=ol(),ee=v(S),N=v(ee);J(()=>X(N,i(b))),y(x,S)};I(D,x=>{i(b)&&x(m)})}var M=g(D,2);{var T=x=>{var S=gl(),ee=v(S),N=v(ee),j=v(N),K=v(j),le=v(K);le.__click=[ll,c];var O=g(K,2);let H;var Y=v(O),Q=v(Y),z=v(Q),U=g(j,2),ne=v(U),be=v(ne);be.__click=[cl,u];var Ie=g(ne,2);let ue;var ye=v(Ie),Se=v(ye),Be=v(Se),Oe=g(ee,2);{var De=fe=>{var xe=fl(),oe=He(xe),de=g(v(oe),2),te=g(oe,2),we=g(v(te),2),je=g(v(we),2),We=v(je);Me(We,17,()=>i(p),ce=>ce.role+ce.content,(ce,Ne)=>{var ft=dl(),la=v(ft),os=v(la);nr(os,()=>R(i(Ne).content)),J(()=>ke(ft,1,`message ${i(Ne).role??""}`,"svelte-ne31rl")),y(ce,ft)});var kt=g(We,2);{var ut=ce=>{var Ne=vl(),ft=v(Ne),la=v(ft);nr(la,()=>R(i(h))),y(ce,Ne)};I(kt,ce=>{i(h)&&ce(ut)})}var Bt=g(kt,2);{var $t=ce=>{var Ne=ul();y(ce,Ne)};I(Bt,ce=>{i(d)&&!i(h)&&ce($t)})}At(je,ce=>w=ce,()=>w);var Wt=g(je,2),Et=v(Wt),Dt=g(Et,2);Dt.__click=q;var Vt=g(Wt,2),Pt=v(Vt);Pt.__click=[al,p,F,d,h,r,b,n,s,o,a,f],J(()=>{Et.disabled=i(d),Dt.disabled=i(d),Pt.disabled=i(F)}),Ke(de,()=>i(o),ce=>l(o,ce)),dt("keypress",Et,ce=>{ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),q())}),Ke(Et,()=>i(_),ce=>l(_,ce)),y(fe,xe)},Je=fe=>{var xe=_l(),oe=g(v(xe),2),de=g(v(oe),2),te=g(v(de),2),we=g(de,2),je=v(we);je.__click=[nl,r];var We=g(we,2);{var kt=ut=>{var Bt=pl(),$t=g(v(Bt),2);$t.__click=k;var Wt=g($t,2);Me(Wt,21,()=>i(a),Qe,(Et,Dt)=>{var Vt=hl(),Pt=v(Vt),ce=v(Pt),Ne=g(Pt,2),ft=v(Ne);J(()=>{X(ce,i(Dt).title),X(ft,i(Dt).summary)}),y(Et,Vt)}),y(ut,Bt)};I(We,ut=>{i(a).length>0&&ut(kt)})}Ke(te,()=>i(r),ut=>l(r,ut)),y(fe,xe)};I(Oe,fe=>{i(f)?fe(Je,!1):fe(De)})}J((fe,xe)=>{Ze(le,"aria-expanded",i(c)),H=ke(O,1,"accordion-collapse collapse svelte-ne31rl",null,H,fe),X(z,i(n)),Ze(be,"aria-expanded",i(u)),ue=ke(Ie,1,"accordion-collapse collapse svelte-ne31rl",null,ue,xe),X(Be,i(s))},[()=>({show:i(c)}),()=>({show:i(u)})]),y(x,S)};I(M,x=>{i(n)&&i(s)&&x(T)})}y(e,E),Te()}vt(["click"]);async function cn(e,t,r,a){l(t,!0),l(r,"");try{const s=await fetch(`/chapter/${a().chapter_number}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chapter_number:a().chapter_number,additional_context:""})});if(!s.ok){const c=await s.text();throw new Error(`Failed to generate chapter: ${s.status} ${s.statusText} - ${c}`)}const o=await s.json();a().content=o.chapter_content,console.log("Chapter generated. Snippet:",o.chapter_content.slice(0,100)+"...")}catch(n){console.error("Generation error:",n),n instanceof Error?l(r,n.message,!0):l(r,"An unknown error occurred during generation.")}finally{l(t,!1)}}async function wl(e,t){if(t().content===void 0||t().content===null){console.warn("No content to save.");return}try{const r=await fetch(`/save_chapter/${t().chapter_number}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chapter_content:t().content})});if(!r.ok){const a=await r.text();throw new Error(`Failed to save chapter: ${r.status} ${r.statusText} - ${a}`)}console.log("Chapter saved successfully!")}catch(r){console.error("Save error:",r),r instanceof Error?console.error("Save failed:",r.message):console.error("An unknown error occurred during saving.")}}async function ml(e,t,r,a,n,s){if(!t().content||t().content.trim()===""){l(r,"No chapter content to read. Please generate content first.");return}l(a,!0),l(r,""),l(n,null);try{const o=await fetch(`/api/tts/chapter/${t().chapter_number}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chapter_number:t().chapter_number,voice:i(s),response_format:"mp3"})});if(!o.ok){const u=await o.text();throw new Error(`Failed to generate audio: ${o.status} ${o.statusText} - ${u}`)}const c=await o.json();if(c.success)l(n,`/static/chapters/chapter_${t().chapter_number}.mp3?t=${Date.now()}`),console.log("Chapter audio generated successfully:",c.filename);else throw new Error(c.error||"Failed to generate audio")}catch(o){console.error("TTS generation error:",o),o instanceof Error?l(r,o.message,!0):l(r,"An unknown error occurred during audio generation.")}finally{l(a,!1)}}var xl=C('<div class="alert alert-info mt-2" role="status"><span class="spinner-border spinner-border-sm me-2" aria-hidden="true"></span> Generating chapter content...</div>'),Cl=C('<div class="alert alert-danger mt-2"> </div>'),kl=C('<p class="card-text small"><!></p> <button class="btn btn-sm btn-primary"><!></button> <!> <!>',1),El=C("<option> </option>"),Tl=C('<span class="spinner-border spinner-border-sm me-1"></span> Generating Audio...',1),Sl=C('<div class="mt-2"><audio controls class="w-100"><source type="audio/mpeg"> Your browser does not support the audio element.</audio></div>'),ql=C('<div class="alert alert-warning alert-sm mt-2"> </div>'),Ol=C('<div class="border rounded p-3 mb-3 bg-light"><h6>Text-to-Speech</h6> <div class="row align-items-center mb-2"><div class="col-md-6"><label class="form-label small">Voice:</label> <select class="form-select form-select-sm"><option>Emma (British Female)</option><!></select></div> <div class="col-md-6"><label class="form-label small">&nbsp;</label> <div><button class="btn btn-primary btn-sm"><!></button></div></div></div> <!> <!></div>'),jl=C('<div class="alert alert-info"><small>TTS server unavailable. Start Kokoro-FastAPI to enable chapter reading.</small></div>'),Al=C('<div class="alert alert-secondary"><small>Checking TTS availability...</small></div>'),$l=C('<div class="alert alert-info mt-2" role="status"><span class="spinner-border spinner-border-sm me-2" aria-hidden="true"></span> Regenerating chapter content...</div>'),Dl=C('<div class="alert alert-danger mt-2"> </div>'),Pl=C('<p class="card-text small text-muted mb-3">Outline: <!></p> <div class="mb-3"><label class="form-label">Chapter Content:</label> <textarea class="form-control" rows="20"></textarea></div> <div class="d-flex justify-content-between mb-3"><button class="btn btn-success">Save Chapter</button> <button class="btn btn-warning"><!></button></div> <!> <!> <!>',1),Rl=C('<div class="card h-100"><div class="card-body"><h4 class="h6 card-title"> </h4> <!></div></div>');function Ml(e,t){Ee(t,!0);let r=se(t,"chapter",7),a=A(!1),n=A(""),s=A(!1),o=A(""),c=A(pe([])),u=A("bf_emma"),f=A(null),p=A("checking");async function _(){try{const E=await(await fetch("/api/tts/status")).json();l(p,E.status==="available"?"available":"unavailable",!0),i(p)==="available"&&await d()}catch(k){console.error("TTS status check failed:",k),l(p,"unavailable")}}async function d(){try{const E=await(await fetch("/api/tts/voices")).json();if(E.error){console.error("Failed to load voices:",E.error);return}l(c,Object.entries(E.voices||{}).map(([W,B])=>({id:W,name:B})),!0)}catch(k){console.error("Failed to load voices:",k)}}$e(()=>{_()});var h=Rl(),b=v(h),w=v(b),q=v(w),R=g(w,2);{var F=k=>{var E=kl(),W=He(E),B=v(W);{var Z=T=>{var x=Ce();J(S=>X(x,`${S??""}...`),[()=>r().prompt.slice(0,100)]),y(T,x)},L=T=>{var x=Ce();J(()=>X(x,r().prompt)),y(T,x)};I(B,T=>{r().prompt.length>100?T(Z):T(L,!1)})}var V=g(W,2);V.__click=[cn,a,n,r];var re=v(V);{var ae=T=>{var x=Ce("Generating...");y(T,x)},ie=T=>{var x=Ce("Generate Chapter");y(T,x)};I(re,T=>{i(a)?T(ae):T(ie,!1)})}var P=g(V,2);{var D=T=>{var x=xl();y(T,x)};I(P,T=>{i(a)&&T(D)})}var m=g(P,2);{var M=T=>{var x=Cl(),S=v(x);J(()=>X(S,`Error: ${i(n)??""}`)),y(T,x)};I(m,T=>{i(n)&&T(M)})}J(()=>V.disabled=i(a)),y(k,E)},$=k=>{var E=Pl(),W=He(E),B=g(v(W));{var Z=O=>{var H=Ce();J(Y=>X(H,`${Y??""}...`),[()=>r().prompt.slice(0,100)]),y(O,H)},L=O=>{var H=Ce();J(()=>X(H,r().prompt)),y(O,H)};I(B,O=>{r().prompt.length>100?O(Z):O(L,!1)})}var V=g(W,2),re=v(V),ae=g(re,2),ie=g(V,2),P=v(ie);P.__click=[wl,r];var D=g(P,2);D.__click=[cn,a,n,r];var m=v(D);{var M=O=>{var H=Ce("Regenerating...");y(O,H)},T=O=>{var H=Ce("Regenerate Chapter");y(O,H)};I(m,O=>{i(a)?O(M):O(T,!1)})}var x=g(ie,2);{var S=O=>{var H=Ol(),Y=g(v(H),2),Q=v(Y),z=v(Q),U=g(z,2),ne=v(U);ne.value=ne.__value="bf_emma";var be=g(ne);Me(be,17,()=>i(c),Qe,(oe,de)=>{var te=El(),we={},je=v(te);J(()=>{we!==(we=i(de).id)&&(te.value=(te.__value=i(de).id)??""),X(je,i(de).name)}),y(oe,te)});var Ie=g(Q,2),ue=g(v(Ie),2),ye=v(ue);ye.__click=[ml,r,o,s,f,u];var Se=v(ye);{var Be=oe=>{var de=Tl();y(oe,de)},Oe=oe=>{var de=Ce("üîä Read Chapter");y(oe,de)};I(Se,oe=>{i(s)?oe(Be):oe(Oe,!1)})}var De=g(Y,2);{var Je=oe=>{var de=Sl(),te=v(de),we=v(te);J(()=>Ze(we,"src",i(f))),y(oe,de)};I(De,oe=>{i(f)&&oe(Je)})}var fe=g(De,2);{var xe=oe=>{var de=ql(),te=v(de);J(()=>X(te,i(o))),y(oe,de)};I(fe,oe=>{i(o)&&oe(xe)})}J(()=>{Ze(z,"for",`voiceSelect_${r().chapter_number??""}`),Ze(U,"id",`voiceSelect_${r().chapter_number??""}`),ye.disabled=i(s)}),Qn(U,()=>i(u),oe=>l(u,oe)),y(O,H)},ee=(O,H)=>{{var Y=z=>{var U=jl();y(z,U)},Q=z=>{var U=Al();y(z,U)};I(O,z=>{i(p)==="unavailable"?z(Y):z(Q,!1)},H)}};I(x,O=>{i(p)==="available"?O(S):O(ee,!1)})}var N=g(x,2);{var j=O=>{var H=$l();y(O,H)};I(N,O=>{i(a)&&O(j)})}var K=g(N,2);{var le=O=>{var H=Dl(),Y=v(H);J(()=>X(Y,`Error: ${i(n)??""}`)),y(O,H)};I(K,O=>{i(n)&&O(le)})}J(()=>{Ze(re,"for",`chapterContent_${r().chapter_number??""}`),Ze(ae,"id",`chapterContent_${r().chapter_number??""}`),D.disabled=i(a)}),Ke(ae,()=>r().content,O=>r().content=O),y(k,E)};I(R,k=>{r().content?k($,!1):k(F)})}J(()=>X(q,`Chapter ${r().chapter_number??""}: ${r().title??""}`)),y(e,h),Te()}vt(["click"]);const Fl=e=>e;function Il(e){const t=e-1;return t*t*t+1}function dn(e){const t=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}function Nl(e,{delay:t=0,duration:r=400,easing:a=Fl}={}){const n=+getComputedStyle(e).opacity;return{delay:t,duration:r,easing:a,css:s=>`opacity: ${s*n}`}}function rs(e,{delay:t=0,duration:r=400,easing:a=Il,x:n=0,y:s=0,opacity:o=0}={}){const c=getComputedStyle(e),u=+c.opacity,f=c.transform==="none"?"":c.transform,p=u*(1-o),[_,d]=dn(n),[h,b]=dn(s);return{delay:t,duration:r,easing:a,css:(w,q)=>`
			transform: ${f} translate(${(1-w)*_}${d}, ${(1-w)*h}${b});
			opacity: ${u-p*q}`}}function zl(e,t){e.key==="Escape"&&t()}var Ll=$r('<svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>'),Hl=$r('<svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>'),Bl=$r('<svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>'),Wl=$r('<svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg>'),Vl=C('<div role="alert" aria-live="polite" tabindex="0"><div class="toast-content svelte-1pwbuv6"><div class="toast-icon svelte-1pwbuv6"><!></div> <div class="toast-message svelte-1pwbuv6"> </div></div> <button class="toast-close svelte-1pwbuv6" aria-label="Close notification"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor"><path d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 01.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 01-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z"></path></svg></button></div>');function Gl(e,t){let r=se(t,"message",3,""),a=se(t,"type",3,"info"),n=se(t,"duration",3,4e3),s=se(t,"onClose",3,()=>{}),o=A(!0),c;n()>0&&(c=setTimeout(()=>{u()},n()));function u(){l(o,!1),clearTimeout(c),setTimeout(s(),300)}var f=ar(),p=He(f);{var _=d=>{var h=Vl();h.__keydown=[zl,u];var b=v(h),w=v(b),q=v(w);{var R=W=>{var B=Ll();y(W,B)},F=(W,B)=>{{var Z=V=>{var re=Hl();y(V,re)},L=(V,re)=>{{var ae=P=>{var D=Bl();y(P,D)},ie=P=>{var D=Wl();y(P,D)};I(V,P=>{a()==="warning"?P(ae):P(ie,!1)},re)}};I(W,V=>{a()==="error"?V(Z):V(L,!1)},B)}};I(q,W=>{a()==="success"?W(R):W(F,!1)})}var $=g(w,2),k=v($),E=g(b,2);E.__click=u,J(()=>{ke(h,1,`toast toast-${a()??""}`,"svelte-1pwbuv6"),X(k,r())}),br(3,h,()=>rs,()=>({y:-50,duration:300})),y(d,h)};I(p,d=>{i(o)&&d(_)})}y(e,f)}vt(["keydown","click"]);var Jl=C('<div class="toast-container svelte-1psg855"></div>');function Ul(e,t){Ee(t,!0);let r=A(pe([]));Mt.subscribe(s=>{l(r,s,!0)});function a(s){Mt.remove(s)}var n=Jl();Me(n,21,()=>i(r),s=>s.id,(s,o)=>{Gl(s,{get message(){return i(o).message},get type(){return i(o).type},get duration(){return i(o).duration},onClose:()=>a(i(o).id)})}),y(e,n),Te()}function Mr(e){l(e,e.v+1)}var Zl=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Yl=["difference","intersection","symmetricDifference","union"],vn=!1,Kt,et,Ot,Kr,as;const Xr=class Xr extends Set{constructor(r){super();_e(this,Kr);_e(this,Kt,new Map);_e(this,et,Ye(0));_e(this,Ot,Ye(0));if(r){for(var a of r)super.add(a);G(this,Ot).v=super.size}vn||Tt(this,Kr,as).call(this)}has(r){var a=super.has(r),n=G(this,Kt),s=n.get(r);if(s===void 0){if(!a)return i(G(this,et)),!1;s=Ye(!0),n.set(r,s)}return i(s),a}add(r){return super.has(r)||(super.add(r),l(G(this,Ot),super.size),Mr(G(this,et))),this}delete(r){var a=super.delete(r),n=G(this,Kt),s=n.get(r);return s!==void 0&&(n.delete(r),l(s,!1)),a&&(l(G(this,Ot),super.size),Mr(G(this,et))),a}clear(){if(super.size!==0){super.clear();var r=G(this,Kt);for(var a of r.values())l(a,!1);r.clear(),l(G(this,Ot),0),Mr(G(this,et))}}keys(){return this.values()}values(){return i(G(this,et)),super.values()}entries(){return i(G(this,et)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return i(G(this,Ot))}};Kt=new WeakMap,et=new WeakMap,Ot=new WeakMap,Kr=new WeakSet,as=function(){vn=!0;var r=Xr.prototype,a=Set.prototype;for(const n of Zl)r[n]=function(...s){return i(G(this,et)),a[n].apply(this,s)};for(const n of Yl)r[n]=function(...s){i(G(this,et));var o=a[n].apply(this,s);return new Xr(o)}};let Ea=Xr;function Kl(e){let t=0,r=Ye(0),a;return()=>{Ks()&&(i(r),Or(()=>(t===0&&(a=xt(()=>e(()=>Mr(r)))),t+=1,()=>{ci().then(()=>{t-=1,t===0&&(a==null||a(),a=void 0)})})))}}function un(e){return Object.prototype.toString.call(e)==="[object Date]"}function Xl(e){return e}function Ql(e){const t=e-1;return t*t*t+1}function Ta(e,t){if(e===t||e!==e)return()=>e;const r=typeof e;if(r!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const a=t.map((n,s)=>Ta(e[s],n));return n=>a.map(s=>s(n))}if(r==="object"){if(!e||!t)throw new Error("Object cannot be null");if(un(e)&&un(t)){const s=e.getTime(),c=t.getTime()-s;return u=>new Date(s+u*c)}const a=Object.keys(t),n={};return a.forEach(s=>{n[s]=Ta(e[s],t[s])}),s=>{const o={};return a.forEach(c=>{o[c]=n[c](s)}),o}}if(r==="number"){const a=t-e;return n=>e+n*a}return()=>t}var ht,Xt,wr,It;const Ha=class Ha{constructor(t,r={}){_e(this,ht,Ye(void 0));_e(this,Xt,Ye(void 0));_e(this,wr);_e(this,It,null);G(this,ht).v=G(this,Xt).v=t,Rt(this,wr,r)}static of(t,r){const a=new Ha(t(),r);return Or(()=>{a.set(t())}),a}set(t,r){var _;l(G(this,Xt),t);let{delay:a=0,duration:n=400,easing:s=Xl,interpolate:o=Ta}={...G(this,wr),...r};if(n===0)return(_=G(this,It))==null||_.abort(),l(G(this,ht),t),Promise.resolve();const c=it.now()+a;let u,f=!1,p=G(this,It);return Rt(this,It,Kn(d=>{if(d<c)return!0;if(!f){f=!0;const b=G(this,ht).v;u=o(b,t),typeof n=="function"&&(n=n(b,t)),p==null||p.abort()}const h=d-c;return h>n?(l(G(this,ht),t),!1):(l(G(this,ht),u(s(h/n))),!0)})),G(this,It).promise}get current(){return i(G(this,ht))}get target(){return i(G(this,Xt))}set target(t){this.set(t)}};ht=new WeakMap,Xt=new WeakMap,wr=new WeakMap,It=new WeakMap;let Sa=Ha;const ec=typeof window<"u"?window:void 0;function tc(e){let t=e.activeElement;for(;t!=null&&t.shadowRoot;){const r=t.shadowRoot.activeElement;if(r===t)break;t=r}return t}var Qt,mr;class rc{constructor(t={}){_e(this,Qt);_e(this,mr);const{window:r=ec,document:a=r==null?void 0:r.document}=t;r!==void 0&&(Rt(this,Qt,a),Rt(this,mr,Kl(n=>{const s=Qa(r,"focusin",n),o=Qa(r,"focusout",n);return()=>{s(),o()}})))}get current(){var t;return(t=G(this,mr))==null||t.call(this),G(this,Qt)?tc(G(this,Qt)):null}}Qt=new WeakMap,mr=new WeakMap;new rc;function ac(e){return!!e&&typeof e=="object"&&"to"in e&&"from"in e&&"event"in e&&"args"in e}var tt,Nt,bt,ns,dr;class nc{constructor(t,r){_e(this,bt);_e(this,tt,A());lr(this,"states");_e(this,Nt,{});l(G(this,tt),t,!0),this.states=r,this.send=this.send.bind(this),this.debounce=this.debounce.bind(this),Tt(this,bt,dr).call(this,"_enter",{from:null,to:t,event:null,args:[]})}send(t,...r){const a=Tt(this,bt,dr).call(this,t,...r);return a&&a!==i(G(this,tt))&&Tt(this,bt,ns).call(this,a,t,r),i(G(this,tt))}async debounce(t=500,r,...a){return G(this,Nt)[r]&&clearTimeout(G(this,Nt)[r]),new Promise(n=>{G(this,Nt)[r]=setTimeout(()=>{delete G(this,Nt)[r],n(this.send(r,...a))},t)})}get current(){return i(G(this,tt))}}tt=new WeakMap,Nt=new WeakMap,bt=new WeakSet,ns=function(t,r,a){const n={from:i(G(this,tt)),to:t,event:r,args:a};Tt(this,bt,dr).call(this,"_exit",n),l(G(this,tt),t,!0),Tt(this,bt,dr).call(this,"_enter",n)},dr=function(t,...r){var n,s;const a=((n=this.states[i(G(this,tt))])==null?void 0:n[t])??((s=this.states["*"])==null?void 0:s[t]);if(a instanceof Function)if(t==="_enter"||t==="_exit")ac(r[0])?a(r[0]):console.warn("Invalid metadata passed to lifecycle function of the FSM.");else return a(...r);else{if(typeof a=="string")return a;t!=="_enter"&&t!=="_exit"&&console.warn("No action defined for event",t,"in state",i(G(this,tt)))}};const pa=[20,20],fn=250,hn=1.2,_a=250,sc=3,ic=3.75,hr=12;function oc(e){if(!(e instanceof Object))return!1;const{x:t,y:r}=e;return typeof t=="number"&&typeof r=="number"}var xr,Cr,kr;class lc{constructor(){_e(this,xr,A(0));_e(this,Cr,A(0));_e(this,kr,A(1))}get x(){return i(G(this,xr))}set x(t){l(G(this,xr),t,!0)}get y(){return i(G(this,Cr))}set y(t){l(G(this,Cr),t,!0)}get scale(){return i(G(this,kr))}set scale(t){l(G(this,kr),t,!0)}translate(t){if(!oc(t))throw new Error(`Invalid coordinate: ${t}`);this.x+=t.x*fn,this.y+=t.y*fn}zoom(t){if(![0,1,-1].includes(Number(t)))throw new Error(`Invalid zoom direction: ${t}`);t===0&&(this.scale=1),t===1&&(this.scale*=hn),t===-1&&(this.scale/=hn)}}xr=new WeakMap,Cr=new WeakMap,kr=new WeakMap;var cc=$r('<svg xmlns="http://www.w3.org/2000/svg"><path class="svelte-3ibi08"></path></svg>');function pn(e,t){Ee(t,!0);const r=Math.PI*.75;let a=me(()=>t.width/2);function n(u,{duration:f=500}){return{duration:f,tick:(p,_)=>{const d=p*r,h=i(a)*Math.cos(d),b=i(a)*Math.sin(d),w=[`M0 ${_*t.height}`,`L${h} ${-b+_*t.height}`,`L${h} ${-b+t.height}`,`L0 ${t.height}`,`L0 ${_*t.height}`].join(" ");u.setAttribute("d",w)}}}var s=cc();let o;var c=v(s);J(()=>{Ze(s,"viewBox",`0 0 ${t.width??""} ${t.height??""}`),ke(s,0,ur(t.side),"svelte-3ibi08"),o=Fe(s,"",o,{"--xflip":t.side==="right"?1:-1})}),br(3,c,()=>n,()=>({duration:t.duration})),y(e,s),Te()}function Fr(e,t){return Math.floor(Math.random()*(t-e+1))+e}const ss=["WO","FC","DR","MA"];function dc(){return ss[Fr(0,3)]}function za(e){return e.toLocaleString("en-us",{style:"percent",roundingMode:"floor"})}var vc=C('<div class="svelte-1sr2rgb"><dt> </dt> <dd><div class="svelte-1sr2rgb"></div></dd></div>'),uc=C('<div class="bin-drawer svelte-1sr2rgb"><div><h3 class="svelte-1sr2rgb"> </h3> <dl class="svelte-1sr2rgb"></dl></div></div>');function fc(e,t){Ee(t,!0);var r=uc(),a=v(r),n=v(a),s=v(n),o=g(n,2);Me(o,21,()=>ss,Qe,(c,u)=>{var f=vc();let p;var _=v(f),d=v(_),h=g(_,2),b=v(h);let w;J(q=>{p=Fe(f,"",p,{color:`var(--color-${i(u)??""})`}),ke(_,1,ur(i(u)),"svelte-1sr2rgb"),X(d,i(u)),ke(h,1,ur(i(u)),"svelte-1sr2rgb"),w=Fe(b,"",w,{width:q})},[()=>za(t.temperCounts[i(u)]/hr)]),y(c,f)}),J(()=>{ke(a,1,ur(["inner",t.open&&"open"]),"svelte-1sr2rgb"),X(s,`0${t.index??""}`)}),dt("transitionend",a,function(...c){var u;(u=t.ontransitionend)==null||u.apply(this,c)}),y(e,r),Te()}var hc=C('<div class="confetti svelte-15ksp55"></div>'),pc=C("<div></div>");function Ir(e,t){Ee(t,!0);const r=se(t,"size",3,10),a=se(t,"x",19,()=>[-.5,.5]),n=se(t,"y",19,()=>[.25,1]),s=se(t,"duration",3,2e3),o=se(t,"infinite",3,!1),c=se(t,"delay",19,()=>[0,50]),u=se(t,"colorRange",19,()=>[0,360]),f=se(t,"colorArray",19,()=>[]),p=se(t,"amount",3,50),_=se(t,"iterationCount",3,1),d=se(t,"fallDistance",3,"100px"),h=se(t,"rounded",3,!1),b=se(t,"cone",3,!1),w=se(t,"noGravity",3,!1),q=se(t,"xSpread",3,.15),R=se(t,"destroyOnComplete",3,!0),F=se(t,"disableForReducedMotion",3,!1);let $=A(!1);ts(()=>{!R()||o()||typeof _()=="string"||setTimeout(()=>l($,!0),(s()+c()[1])*_())});function k(L,V){return Math.random()*(V-L)+L}function E(){return f().length?f()[Math.round(Math.random()*(f().length-1))]:`hsl(${Math.round(k(u()[0],u()[1]))}, 75%, 50%)`}var W=ar(),B=He(W);{var Z=L=>{var V=pc();let re;Me(V,21,()=>({length:p()}),Qe,(ae,ie)=>{var P=hc();J((D,m,M,T,x,S,ee,N,j,K,le)=>Fe(P,`
        --color: ${D??""};
        --skew: ${m??""}deg,${M??""}deg;
        --rotation-xyz: ${T??""}, ${x??""}, ${S??""};
        --rotation-deg: ${ee??""}deg;
        --translate-y-multiplier: ${N??""};
        --translate-x-multiplier: ${j??""};
        --scale: ${K??""};
        --transition-delay: ${le??""}ms;
        --transition-duration: ${o()?`calc(${s()}ms * var(--scale))`:`${s()}ms`};`),[E,()=>k(-45,45),()=>k(-45,45),()=>k(-10,10),()=>k(-10,10),()=>k(-10,10),()=>k(0,360),()=>k(n()[0],n()[1]),()=>k(a()[0],a()[1]),()=>.1*k(2,10),()=>k(c()[0],c()[1])]),y(ae,P)}),J(ae=>{re=ke(V,1,"confetti-holder svelte-15ksp55",null,re,ae),Fe(V,`
    --fall-distance: ${d()??""};
    --size: ${r()??""}px;
    --x-spread: ${1-q()};
    --transition-iteration-count: ${(o()?"infinite":_())??""};`)},[()=>({rounded:h(),cone:b(),"no-gravity":w(),"reduced-motion":F()})]),y(L,V)};I(B,L=>{i($)||L(Z)})}y(e,W),Te()}var _c=C('<div class="rear-lid svelte-ayzug8"></div> <!> <!> <!>',1),gc=C('<div class="confetti-container svelte-ayzug8"><!></div>'),bc=C('<div class="bin svelte-ayzug8"><div class="box svelte-ayzug8"><div class="front svelte-ayzug8"> </div> <!> <!></div> <div class="progress svelte-ayzug8"><div class="bar svelte-ayzug8"></div> <div class="value svelte-ayzug8"> </div></div></div>');function yc(e,t){Ee(t,!0);const r=20,a=500;let n,s=A(pe({WO:0,FC:0,DR:0,MA:0})),o=me(()=>Object.values(i(s)).reduce((m,M)=>m+M,0)),c=me(()=>za(i(o)/(hr*4))),u=me(()=>t.selected&&Ae.current!=="ready"),f=me(()=>t.selected&&Ae.current==="binDrawerOpen"),p=A(void 0),_=A(!1),d=A(!1);const h=[{x:[-.25,1.5]},{x:[-.25,.75]},{x:[-.25,.25]},{x:[-.75,.25]},{x:[-1.5,.25]}];$e(()=>{i(o)>=hr*4&&!i(d)&&(l(_,!0),l(d,!0),setTimeout(()=>{l(_,!1)},2100))});function b(){return n.getBoundingClientRect()}function w(){const m=dc();i(s)[m]<hr&&i(s)[m]++}function q(){return i(o)}function R(){l(s,{WO:0,FC:0,DR:0,MA:0},!0),l(d,!1)}var F=bc();let $;var k=v(F),E=v(k),W=v(E),B=g(E,2);{var Z=m=>{var M=_c(),T=He(M),x=g(T,2);pn(x,{height:r,get width(){return i(p)},duration:a,side:"left"});var S=g(x,2);pn(S,{height:r,get width(){return i(p)},duration:a,side:"right"});var ee=g(S,2);fc(ee,{get index(){return t.index},get temperCounts(){return i(s)},get open(){return i(f)},ontransitionend:()=>Ae.send("transitionEnded")}),dt("introend",T,()=>Ae.send("transitionEnded")),br(3,T,()=>rs,()=>({duration:a,opacity:1,y:r})),y(m,M)};I(B,m=>{i(u)&&m(Z)})}var L=g(B,2);{var V=m=>{var M=gc(),T=v(M);Ir(T,{cone:!0,get x(){return h[t.index-1].x},y:[.75,2.25],amount:"50",rounded:!0,size:"15",fallDistance:"250px",colorArray:["#a8e0d8","#f0f5c0","#f0c8e8","#7cc5e8"]}),J(()=>Ze(M,"data-bin",t.index)),y(m,M)};I(L,m=>{i(_)&&m(V)})}var re=g(k,2),ae=v(re);let ie;var P=g(ae,2),D=v(P);return At(F,m=>n=m,()=>n),J(()=>{$=Fe(F,"",$,{"--height":"20px","--width":`${i(p)??""}px`}),X(W,`0${t.index??""}`),ie=Fe(ae,"",ie,{width:i(c)}),X(D,i(c))}),Ri(F,"offsetWidth",m=>l(p,m)),y(e,F),Te({getBoundingClientRect:b,addItem:w,getBinCount:q,reset:R})}const wc=[1,2,3,4,5];var Er,Tr;class mc{constructor(){_e(this,Er,A(pe({})));_e(this,Tr,A())}get instances(){return i(G(this,Er))}set instances(t){l(G(this,Er),t,!0)}get selectedIndex(){return i(G(this,Tr))}set selectedIndex(t){l(G(this,Tr),t,!0)}get indices(){return wc}get selectedBin(){return this.selectedIndex&&this.instances[this.selectedIndex]}get percentComplete(){const t=Object.values(this.instances);return t.reduce((a,n)=>a+n.getBinCount(),0)/(hr*4*t.length)||0}selectBin(t){const r=Number(t);if(!this.isBinIndex(r))throw new Error(`Invalid bin index: ${t}`);this.selectedIndex=r}isBinIndex(t){const r=Number(t);return this.indices.some(a=>a===r)}resetAllBins(){Object.values(this.instances).forEach(t=>{t&&t.reset&&t.reset()})}}Er=new WeakMap,Tr=new WeakMap;const Zt=new lc,Ft=new Ea,gt=new mc,La=new Sa(0,{duration:(e,t)=>Math.round((t-e)*5e3)}),Ae=new nc("ready",{ready:{_enter(){gt.selectedIndex=void 0},panViewport(e){Zt.translate(e)},zoomViewport(e){Zt.zoom(e)},selectCell(e){if(!(e instanceof PointerEvent&&e.target instanceof HTMLElement))return;const{index:t}=e.target.dataset;e.buttons&&t&&Ft.add(Number(t))},clearCells(){Ft.clear()},selectBin(e){return gt.selectBin(e),"openingBin"}},openingBin:{transitionEnded:"fillingBin"},fillingBin:{_enter(){Ft.size===0&&Ae.debounce(500,"done")},addToBin(e){var t;typeof e=="number"&&(Ft.delete(e),(t=gt.selectedBin)==null||t.addItem(),Ft.size===0&&Ae.debounce(500,"done"))},done:"binDrawerOpen"},binDrawerOpen:{transitionEnded(){Ae.debounce(1e3,"done")},done:"closingBin"},closingBin:{_exit(){La.target=gt.percentComplete},transitionEnded:"ready"}}),xc=`<svg viewBox="0 0 242 123" xmlns="http://www.w3.org/2000/svg">
<g class="bg" fill="none">
	<ellipse cx="121" cy="61.5" rx="121" ry="61.5" />
</g>
<g class="fg" fill="white">
	<path d="M201.667 47.3333V63.6667L181.17 47.3333H176.667V70.3333H182V54.6667L201.66 70.3333H207.333V47.3333H201.667Z" />
	<path fill-rule="evenodd" clip-rule="evenodd" d="M146 47.3333C143.239 47.3333 141 49.572 141 52.3333V65.3333C141 68.0947 143.239 70.3333 146 70.3333H168.667C171.428 70.3333 173.667 68.0947 173.667 65.3333V52.3333C173.667 49.572 171.428 47.3333 168.667 47.3333H146ZM152.595 59C152.597 59 152.598 59.0023 152.597 59.0047C152.215 59.7533 152 60.6017 152 61.5C152 64.5377 154.462 67 157.5 67C160.538 67 163 64.5377 163 61.5C163 60.6017 162.785 59.7533 162.403 59.0047C162.402 59.0023 162.403 59 162.405 59C162.408 59 162.409 58.9973 162.408 58.9953L158.08 51.357C157.825 50.9063 157.175 50.9063 156.92 51.357L152.592 58.9953C152.591 58.9973 152.592 59 152.595 59Z" />
	<path d="M107 47.3333H102.333V70.3333H107.667V56.8333L117.678 70.3333H121.822L131.833 56.8333V70.3333H137.333V47.3333H132.333L119.667 64.5L107 47.3333Z" />
	<path d="M71.3333 47.3333H66V65.3333C66 68.0947 68.2387 70.3333 71 70.3333H93.3333C96.0947 70.3333 98.3333 68.0947 98.3333 65.3333V47.3333H93V63.6667C93 65.1393 91.806 66.3333 90.3333 66.3333H74C72.5273 66.3333 71.3333 65.1393 71.3333 63.6667V47.3333Z" />
	<path d="M40 47.3333H34.6667V70.3333H62.3333V66.3333H40V47.3333Z" />
	<path fill-rule="evenodd" clip-rule="evenodd" d="M122 0C122.225 0 122.449 0.0006363 122.674 0.00190656C122.782 0.0006363 122.891 0 123 0C123.314 0 123.627 0.00528843 123.939 0.0158092C124.069 0.0179395 124.2 0.0202845 124.33 0.0228434C189.617 0.919517 242 28.1005 242 61.5C242 94.8993 189.617 122.08 124.33 122.977C124.253 122.979 124.176 122.98 124.099 122.981C124.046 122.982 123.992 122.983 123.939 122.984C123.627 122.995 123.314 123 123 123C122.945 123 122.89 123 122.835 123C122.781 122.999 122.727 122.999 122.674 122.998C122.449 122.999 122.225 123 122 123C121.945 123 121.891 123 121.836 123C121.754 123 121.671 123 121.588 122.999C121.392 123 121.196 123 121 123C54.1737 123 0 95.4657 0 61.5C0 27.5345 54.1737 0 121 0C121.196 0 121.392 0.0002374 121.588 0.000711667C121.725 0.000237393 121.863 0 122 0ZM239 61.5C239 73.8497 230.984 85.7633 216.499 95.6667H192.409C196.735 90.972 200.195 85.8207 202.623 80.3333H199.321C196.701 85.835 192.955 90.9953 188.245 95.6667H157.096C159.191 90.972 160.866 85.8207 162.042 80.3333H158.971C157.739 85.872 155.98 91.028 153.796 95.6667H92.2043C90.0197 91.028 88.2613 85.872 87.0287 80.3333H83.9583C85.1337 85.8207 86.8093 90.972 88.904 95.6667H55.755C51.045 90.9953 47.2993 85.835 44.6793 80.3333H41.377C43.8047 85.8207 47.2647 90.972 51.5907 95.6667H25.501C11.0161 85.7633 3 73.8497 3 61.5C3 48.164 12.3475 35.3363 29.0942 25H53.8503C49.5983 29.1818 46.0587 33.7687 43.3607 38.6667H46.8173C49.739 33.7503 53.587 29.1559 58.2333 25H89.9983C87.9393 29.1818 86.2253 33.7687 84.9187 38.6667H88.028C89.4023 33.719 91.2067 29.128 93.362 25H152.638C154.793 29.128 156.598 33.719 157.972 38.6667H161.081C159.775 33.7687 158.061 29.1818 156.002 25H185.767C190.413 29.1559 194.261 33.7503 197.183 38.6667H200.639C197.941 33.7687 194.402 29.1818 190.15 25H212.906C229.652 35.3363 239 48.164 239 61.5ZM189.111 99H211.249C209.324 100.137 207.307 101.242 205.201 102.313C192.383 108.827 176.56 113.885 158.829 116.893C170.747 112.704 181.108 106.546 189.111 99ZM184.623 99H155.499C150.943 107.87 144.81 114.822 137.729 118.912C154.187 116.604 168.832 110.748 180.105 102.56C181.68 101.416 183.187 100.228 184.623 99ZM149.495 103.323C150.41 101.951 151.281 100.508 152.104 99H93.8957C94.719 100.508 95.59 101.951 96.5047 103.323C103.452 113.744 112.689 119.802 122.515 119.995C122.992 119.992 123.468 119.988 123.944 119.982C133.598 119.612 142.656 113.582 149.495 103.323ZM90.5013 99H59.3767C60.8127 100.228 62.3197 101.416 63.8947 102.56C75.7553 111.175 91.3483 117.208 108.859 119.244C101.53 115.204 95.1823 108.114 90.5013 99ZM54.8887 99H30.7506C32.6761 100.137 34.6933 101.242 36.7993 102.313C50.5193 109.286 67.6817 114.59 86.9433 117.497C74.2797 113.307 63.286 106.917 54.8887 99ZM207.085 21.6667C206.465 21.3371 205.837 21.0106 205.201 20.6873C192.383 14.1725 176.56 9.11517 158.829 6.1074C169.494 9.8556 178.912 15.181 186.51 21.6667H207.085ZM181.746 21.6667C181.208 21.2525 180.661 20.8436 180.105 20.4402C168.832 12.2517 154.187 6.3959 137.729 4.08767C144.176 7.8118 149.838 13.9094 154.239 21.6667H181.746ZM150.761 21.6667C150.349 20.9881 149.927 20.3247 149.495 19.677C142.656 9.4178 133.598 3.3878 123.944 3.01807C123.468 3.01222 122.992 3.00779 122.515 3.00478C112.689 3.19816 103.452 9.25557 96.5047 19.677C96.073 20.3247 95.651 20.9881 95.239 21.6667H150.761ZM91.761 21.6667C96.295 13.6744 102.168 7.44397 108.859 3.75583C91.3483 5.7918 75.7553 11.825 63.8947 20.4402C63.3393 20.8436 62.7923 21.2525 62.254 21.6667H91.761ZM57.4903 21.6667C65.506 14.8241 75.5483 9.27297 86.9433 5.503C67.6817 8.4105 50.5193 13.714 36.7993 20.6873C36.1633 21.0106 35.5353 21.3371 34.9153 21.6667H57.4903Z" />
</g>
</svg>
`;var Cc=C('<li class="svelte-tra2jp"></li>'),kc=C('<header class="svelte-tra2jp"><div class="inner svelte-tra2jp"><ul class="progress svelte-tra2jp"></ul> <h1 class="svelte-tra2jp">hypeWriter</h1> <h2 class="svelte-tra2jp"> </h2></div> <!></header>');function Ec(e,t){Ee(t,!0);let r=se(t,"progressOverride",3,null),a=me(()=>r()!==null?r():La.current),n=me(()=>za(i(a))),s=me(()=>Math.ceil(i(a)*50));var o=kc(),c=v(o),u=v(c);let f;Me(u,21,()=>({length:i(s)}),Qe,(h,b,w)=>{var q=Cc();Fe(q,"",{},{"--index":w}),y(h,q)});var p=g(u,4),_=v(p),d=g(c,2);nr(d,()=>xc),J(()=>{f=Fe(u,"",f,{"--progress":i(n)}),X(_,`${i(n)??""} Complete`)}),y(e,o),Te()}function Tc({left:e,top:t,width:r,height:a}){return{x:e+r/2,y:t+a/2}}function qa(e){return Tc(e.getBoundingClientRect())}function is(e,t){const r=t.x-e.x,a=t.y-e.y,n=Math.sqrt(r*r+a*a);return{dx:r,dy:a,magnitude:n}}function Sc(e,t){return is(qa(e),qa(t))}function qc({dx:e,dy:t,magnitude:r},a){return{dx:e/a,dy:t/a,magnitude:r/a}}var Oc=C("<div> </div>"),jc=C('<div class="data-cell svelte-u0vxsv"><!></div>');function Ac(e,t){Ee(t,!0);let r=A(void 0),a=A(void 0),n=me(()=>t.selected&&Ae.current==="fillingBin"),s=me(()=>{if(!i(r))return 1;if(t.selected)return ic;const{magnitude:d}=is(t.cursor,qa(i(r)));if(d>_a)return 1;const h=(_a-d)/_a;return 1+(sc-1)*h});$e(()=>{Ae.current==="ready"&&!i(a)&&o()});function o(){setTimeout(()=>{l(a,{value:Fr(0,9),range:Math.random()*15,duration:Fr(3e3,1e4),axis:Fr(0,1)?"x":"y"},!0)})}function c(){Ae.send("addToBin",t.index),l(a,void 0)}function u(d){if(!gt.selectedBin)return{};const h=Sc(d,gt.selectedBin),{dx:b,dy:w}=qc(h,Zt.scale);return{duration:h.magnitude*1.25,css:(q,R)=>`translate: ${b*Ql(R)}px ${w*R}px`}}var f=jc(),p=v(f);{var _=d=>{var h=Oc();const b=me(()=>{const{value:R,axis:F,range:$,duration:k}=i(a);return{value:R,axis:F,range:$,duration:k}});let w;var q=v(h);J(()=>{ke(h,1,ur(["inner",i(b).axis]),"svelte-u0vxsv"),w=Fe(h,"",w,{"--range":`${i(b).range??""}%`,"--duration":`${i(b).duration??""}ms`,"--number-scale":i(s)}),X(q,i(b).value)}),dt("outroend",h,c),br(1,h,()=>Nl,()=>({duration:i(b).duration/2})),br(2,h,()=>u),y(d,h)};I(p,d=>{i(a)&&!i(n)&&d(_)})}At(f,d=>l(r,d),()=>i(r)),J(()=>Ze(f,"data-index",t.index)),y(e,f),Te()}function $c(e,t){t.x=e.clientX,t.y=e.clientY}var Dc=e=>Ae.send("selectCell",e),Pc=e=>Ae.send("selectCell",e),Rc=C('<section class="svelte-1e5vptc"><div class="inner svelte-1e5vptc"></div></section>');function Mc(e,t){Ee(t,!0);let r=A(pe([])),a=pe({x:0,y:0});$e(()=>{l(r,Array.from({length:pa[0]*pa[1]}),!0)});function n(p){let _=0,d=0;p==="Right"&&(_=-1),p==="Left"&&(_=1),p==="Up"&&(d=1),p==="Down"&&(d=-1),Ae.send("panViewport",{x:_,y:d})}function s(p){let _=0;["=","+"].includes(p)&&(_=1),["-","_"].includes(p)&&(_=-1),Ae.send("zoomViewport",_)}function o({key:p}){p==="Escape"&&Ae.send("clearCells"),p.startsWith("Arrow")&&n(p.replace("Arrow","")),["=","+","-","_","0"].includes(p)&&s(p)}var c=Rc();dt("keyup",Hr,o),dt("pointerdown",Hr,()=>Ft.clear(),!0),c.__pointermove=[$c,a],c.__pointerdown=[Dc],c.__pointerover=[Pc];let u;var f=v(c);Me(f,21,()=>i(r),Qe,(p,_,d)=>{const h=me(()=>Ft.has(d));Ac(p,{index:d,get cursor(){return a},get selected(){return i(h)}})}),J(()=>u=Fe(c,"",u,{"--cols":pa[0],"--x":`${Zt.x??""}px`,"--y":`${Zt.y??""}px`,"--scale":Zt.scale})),y(e,c),Te()}vt(["pointermove","pointerdown","pointerover"]);js();var Jt=Fi(()=>gt),Fc=C('<section class="svelte-1goxhl1"></section>');function Ic(e,t){Ee(t,!1);function r({key:n}){Jt().isBinIndex(n)&&Ae.send("selectBin",n)}Mi();var a=Fc();dt("keyup",Hr,r),Me(a,5,()=>Jt().indices,Qe,(n,s)=>{const o=Ra(()=>i(s)===Jt().selectedIndex);At(yc(n,{get index(){return i(s)},get selected(){return i(o)},$$legacy:!0}),(c,u)=>Jt(Jt().instances[u]=c),c=>{var u,f;return(f=(u=Jt())==null?void 0:u.instances)==null?void 0:f[c]},()=>[i(s)])}),y(e,a),Te()}var Nc=C('<span class="svelte-1gidgvk"> </span>'),zc=C('<footer class="svelte-1gidgvk"></footer>');function Lc(e,t){Ee(t,!0);let r=A(pe([]));function a(){return Math.random().toString(16).slice(2,8).padEnd(6,"0")}$e(()=>{l(r,[a(),a()].sort(),!0)});var n=zc();Me(n,21,()=>i(r),Qe,(s,o)=>{var c=Nc(),u=v(c);J(()=>X(u,`0x${i(o)??""}`)),y(s,c)}),y(e,n),Te()}var Hc=C('<div class="big-explosion svelte-1iwmhq9"><!> <!> <!></div>');function Bc(e,t){let r=se(t,"show",3,!1);var a=ar(),n=He(a);{var s=o=>{var c=Hc(),u=v(c);Ir(u,{noGravity:!0,amount:"300",size:"25",x:[-3,3],y:[-3,3],delay:[0,550],duration:"550",rounded:!0,colorArray:["#a8e0d8","#f0f5c0","#f0c8e8","#7cc5e8"]});var f=g(u,2);Ir(f,{noGravity:!0,amount:"200",size:"15",x:[-3,3],y:[-2.5,2.5],delay:[150,750],duration:"750",rounded:!0,colorArray:["#a8e0d8","#f0f5c0","#f0c8e8","#7cc5e8"]});var p=g(f,2);Ir(p,{noGravity:!0,amount:"300",size:"15",x:[-3,3],y:[-2,2],delay:[200,1050],duration:"1200",rounded:!0,colorArray:["#40E7F6","#00A1D3","#91F2FF","#A4DAE3"]}),y(o,c)};I(n,o=>{r()&&o(s)})}y(e,a)}var Wc=C('<div class="dashboard-overlay svelte-1nxprc4"><div class="dashboard-wrapper svelte-1nxprc4"><!></div></div>');function Vc(e){var t=Wc(),r=v(t),a=v(r);Co(a,{}),y(e,t)}const Gc="data:image/svg+xml,%3csvg%20width='28'%20height='30'%20viewBox='0%200%2014%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M3%201L4.51823%2012.4066L7.22895%208.35127L12.1193%208.01814L3%201Z'%20stroke='%230F1E2E'%20stroke-opacity='0.5'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M3%201L4.51823%2012.4066L7.22895%208.35127L12.1193%208.01814L3%201Z'%20fill='%230F1E2E'%20stroke='%23B3D9E6'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";var Jc=C('<div class="page-overlay svelte-1yah834"><!></div>'),Uc=C('<div class="mdr-background svelte-1yah834"><main class="svelte-1yah834"><!> <div class="datafield-container svelte-1yah834"><!> <!></div> <!> <!></main> <!> <!></div>');function Zc(e,t){Ee(t,!0);const r=`url("${Gc}"), default`;let a=A(!1),n=A(!1);$e(()=>{gt.percentComplete>=1&&!i(n)&&(l(n,!0),setTimeout(()=>{l(a,!0),setTimeout(()=>{gt.resetAllBins(),La.target=0,l(n,!1)},1e3),setTimeout(()=>{l(a,!1)},2e3)},2200))});let s=A(pe(window.location.pathname));function o(){l(s,window.location.pathname,!0)}window.addEventListener("popstate",o);var c=Uc();Fe(c,"",{},{cursor:r});var u=v(c),f=v(u);Ec(f,{});var p=g(f,2),_=v(p);Mc(_,{});var d=g(_,2);{var h=$=>{Vc($)},b=$=>{var k=Jc(),E=v(k);{var W=Z=>{Lo(Z,{})},B=(Z,L)=>{{var V=ae=>{rl(ae,{})},re=(ae,ie)=>{{var P=m=>{yl(m,{})},D=(m,M)=>{{var T=x=>{Ml(x,{})};I(m,x=>{i(s)==="/chapters"&&x(T)},M)}};I(ae,m=>{i(s)==="/outline"?m(P):m(D,!1)},ie)}};I(Z,ae=>{i(s)==="/characters"?ae(V):ae(re,!1)},L)}};I(E,Z=>{i(s)==="/world"?Z(W):Z(B,!1)})}y($,k)};I(d,$=>{i(s)==="/"||i(s)===""?$(h):$(b,!1)})}var w=g(p,2);Ic(w,{});var q=g(w,2);Lc(q,{});var R=g(u,2);Bc(R,{get show(){return i(a)}});var F=g(R,2);Ul(F,{}),y(e,c),Te()}pi(Zc,{target:document.getElementById("app")});
